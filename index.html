<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>üêæ Ìé´ ÏãúÏä§ÌÖú ÌîÑÎ°úÌÜ†ÌÉÄÏûÖ</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { background: #0a0e17; overflow: hidden; }
    ::-webkit-scrollbar { width: 4px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: #2d3748; border-radius: 4px; }
    @keyframes popIn {
      0% { transform: scale(0.3); opacity: 0; }
      70% { transform: scale(1.1); }
      100% { transform: scale(1); opacity: 1; }
    }
    @keyframes pulse { 0%,100% { opacity: 1; } 50% { opacity: 0.7; } }
    @keyframes shimmer {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }
    @keyframes slideUp {
      0% { transform: translateY(20px); opacity: 0; }
      100% { transform: translateY(0); opacity: 1; }
    }
    @keyframes glow {
      0%, 100% { filter: drop-shadow(0 0 15px rgba(229,62,62,0.4)); }
      50% { filter: drop-shadow(0 0 30px rgba(229,62,62,0.7)); }
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
  <script type="text/babel">
    const { useState, useCallback, useMemo, useEffect, useRef } = React;

    // ============================================================
    // DATA & CONFIG
    // ============================================================
    const GRADES = ["C", "B", "A", "S", "SS"];
    const GRADE_COLORS = {
      C: { bg: "#4a5568", text: "#cbd5e0", glow: "rgba(74,85,104,0.4)", accent: "#718096" },
      B: { bg: "#2b6cb0", text: "#bee3f8", glow: "rgba(43,108,176,0.4)", accent: "#63b3ed" },
      A: { bg: "#6b46c1", text: "#d6bcfa", glow: "rgba(107,70,193,0.5)", accent: "#b794f4" },
      S: { bg: "#c05621", text: "#feebc8", glow: "rgba(192,86,33,0.5)", accent: "#f6ad55" },
      SS: { bg: "#e53e3e", text: "#fff5f5", glow: "rgba(229,62,62,0.6)", accent: "#fc8181" },
    };

    const PULL_RATES = { C: 0.55, B: 0.3, A: 0.12, S: 0.03 };
    const MAX_ENHANCE = { C: 0, B: 1, A: 1, S: 2, SS: 0 };
    const FUSION_NEED = { C: 4, B: 3, A: 2 };
    const FEED_REWARD = { C: 1, B: 2, A: 4 };
    const S_EXCHANGE_COST = 35;

    const PET_EMOJIS = {
      C: ["üêõ", "üêå", "üê∏", "ü¶é"],
      B: ["üê∫", "ü¶ä", "üêª", "ü¶Å", "üêØ", "ü¶Ö", "ü¶à", "üêô"],
      A: ["üê≤", "ü¶Ñ", "ü¶á", "üêç", "ü¶Ç", "ü¶ë", "üêã", "ü¶è"],
      S: ["üî•", "‚ùÑÔ∏è", "‚ö°", "üåä", "üåë", "‚òÄÔ∏è", "üíé", "üåô", "üå™Ô∏è", "‚òÑÔ∏è", "üå∏", "‚≠ê"],
      SS: ["üëë", "üèÜ", "üí´", "üîÆ", "‚öúÔ∏è", "üåü"],
    };

    const PET_NAMES = {
      C: ["Ïä¨ÎùºÏûÑ", "Îã¨ÌåΩÏù¥", "Í∞úÍµ¨ÎßÅ", "ÎèÑÎßàÎ±Ä"],
      B: ["ÎäëÎåÄ", "Ïó¨Ïö∞", "Í≥∞ÎèåÏù¥", "ÏÇ¨Ïûê", "Ìò∏ÎûëÏù¥", "ÎèÖÏàòÎ¶¨", "ÏÉÅÏñ¥", "Î¨∏Ïñ¥"],
      A: ["ÎìúÎûòÍ≥§Jr", "Ïú†ÎãàÏΩò", "Î∞ïÏ•êÏôï", "Î±ÄÌååÏù¥Ïñ¥", "Ï†ÑÍ∞àÏôï", "ÌÅ¨ÎùºÏºÑ", "Í≥†ÎûòÏôï", "ÏΩîÎøîÏÜå"],
      S: ["ÌôîÏóºÏàòÌò∏Ïûê", "ÎπôÍ≤∞Ï†ïÎ†π", "Î≤àÍ∞úÏÇ¨Ïûê", "Ìï¥ÏùºÏö©", "ÏïîÌùëÍ∏∞ÏÇ¨", "ÌÉúÏñëÏ°∞", "Îã§Ïù¥ÏïÑÍ≥®Î†ò", "ÏõîÍ¥ëÎäëÎåÄ", "Ìè≠ÌíçÎß§", "Ïú†ÏÑ±ÎìúÎûòÍ≥§", "Î≤öÍΩÉÏöîÏ†ï", "Î≥ÑÏùòÏàòÌò∏Ïûê"],
      SS: ["Î∂àÎ©∏ÏùòÌîºÎãâÏä§", "Ï†àÎåÄÏòÅÎèÑ", "Ï≤úÎë•Ï†úÏôï", "Ïã¨Ïó∞ÏùòÍµ∞Ï£º", "Ï≤úÏÉÅÏùòÎπõ", "ÏÑ±Ïö¥ÏùòÏö©"],
    };

    const SS_RECIPES = [
      { result: 0, mat1: 0, mat2: 1, name: "ÌôîÏóºÏàòÌò∏Ïûê + ÎπôÍ≤∞Ï†ïÎ†π" },
      { result: 1, mat1: 2, mat2: 3, name: "Î≤àÍ∞úÏÇ¨Ïûê + Ìï¥ÏùºÏö©" },
      { result: 2, mat1: 4, mat2: 5, name: "ÏïîÌùëÍ∏∞ÏÇ¨ + ÌÉúÏñëÏ°∞" },
      { result: 3, mat1: 6, mat2: 7, name: "Îã§Ïù¥ÏïÑÍ≥®Î†ò + ÏõîÍ¥ëÎäëÎåÄ" },
      { result: 4, mat1: 8, mat2: 9, name: "Ìè≠ÌíçÎß§ + Ïú†ÏÑ±ÎìúÎûòÍ≥§" },
      { result: 5, mat1: 10, mat2: 11, name: "Î≤öÍΩÉÏöîÏ†ï + Î≥ÑÏùòÏàòÌò∏Ïûê" },
    ];

    // PASSIVE_COUNT: C=0, B=1, A=1, S=2, SS=2
    const PASSIVE_COUNT = { C: 0, B: 1, A: 1, S: 2, SS: 2 };
    // Cooldown reduction per enhance level (B/A: -1 at max, S: -1 per level)
    const COOL_REDUCE = { C: 0, B: 1, A: 1, S: 1, SS: 0 };

    const PET_SKILLS = {
      C: [
        { active: { name: "ÎèÖ ÎøúÍ∏∞", desc: "Ï†ÅÏóêÍ≤å ÎèÖ Îç∞ÎØ∏ÏßÄ 50", cooldown: 8 }, passives: [] },
        { active: { name: "ÍªçÏßà Î∞©Ïñ¥", desc: "Ïù¥Î≤à ÌÑ¥ Î∞õÎäî ÌîºÌï¥ 20% Í∞êÏÜå", cooldown: 10 }, passives: [] },
        { active: { name: "ÎèÖÏπ®", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 80%Ïùò ÎèÖ Îç∞ÎØ∏ÏßÄ", cooldown: 9 }, passives: [] },
        { active: { name: "Íº¨Î¶¨ ÏπòÍ∏∞", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 90%Ïùò Îç∞ÎØ∏ÏßÄ", cooldown: 8 }, passives: [] },
      ],
      B: [
        { active: { name: "ÎäëÎåÄÏùò Ïö∏Î∂ÄÏßñÏùå", desc: "3ÌÑ¥Í∞Ñ Í≥µÍ≤©Î†• 12% Ï¶ùÍ∞Ä", cooldown: 8 },
          passives: [{ name: "Ï∂îÏ†Å Î≥∏Îä•", base: "Ï£ºÏù∏Í≥µÏù¥ 3Ìöå Ïó∞ÏÜç Í≥µÍ≤© Ïãú 25% ÌôïÎ•†Î°ú Ï∂îÍ∞Ä ÌÉÄÍ≤©", enhanced: "Ï£ºÏù∏Í≥µÏù¥ 3Ìöå Ïó∞ÏÜç Í≥µÍ≤© Ïãú 40% ÌôïÎ•†Î°ú Ï∂îÍ∞Ä ÌÉÄÍ≤©" }] },
        { active: { name: "ÌôòÏòÅ ÎèåÏßÑ", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 150%Ïùò Îç∞ÎØ∏ÏßÄ", cooldown: 7 },
          passives: [{ name: "ÍµêÌôúÌï®", base: "Ï£ºÏù∏Í≥µ ÌîºÍ≤© Ïãú 20% ÌôïÎ•†Î°ú ÌôòÏòÅ ÎèåÏßÑ Ïø®ÌÉÄÏûÑ 2 Í∞êÏÜå", enhanced: "Ï£ºÏù∏Í≥µ ÌîºÍ≤© Ïãú 35% ÌôïÎ•†Î°ú ÌôòÏòÅ ÎèåÏßÑ Ïø®ÌÉÄÏûÑ 2 Í∞êÏÜå" }] },
        { active: { name: "Í≥∞Ïùò Ìè¨Ïòπ", desc: "3ÌÑ¥Í∞Ñ Î∞©Ïñ¥Î†• 20% Ï¶ùÍ∞Ä", cooldown: 9 },
          passives: [{ name: "Î∂ÑÎÖ∏", base: "Ï£ºÏù∏Í≥µ HP 50% Ïù¥ÌïòÏùº Îïå Í≥∞Ïùò Ìè¨Ïòπ Î∞©Ïñ¥Î†• Ï¶ùÍ∞ÄÎüâ +15%", enhanced: "Ï£ºÏù∏Í≥µ HP 50% Ïù¥ÌïòÏùº Îïå Í≥∞Ïùò Ìè¨Ïòπ Î∞©Ïñ¥Î†• Ï¶ùÍ∞ÄÎüâ +30%" }] },
        { active: { name: "ÏôïÏùò Ìè¨Ìö®", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 80%Ïùò Îç∞ÎØ∏ÏßÄ", cooldown: 10 },
          passives: [{ name: "ÏúÑÏïï", base: "ÏôïÏùò Ìè¨Ìö® Î∞úÎèô Ïãú 30% ÌôïÎ•†Î°ú Ï†Å Ï†ÑÏ≤¥ 1ÌÑ¥ Í∏∞Ï†à", enhanced: "ÏôïÏùò Ìè¨Ìö® Î∞úÎèô Ïãú 50% ÌôïÎ•†Î°ú Ï†Å Ï†ÑÏ≤¥ 1ÌÑ¥ Í∏∞Ï†à" }] },
        { active: { name: "ÎßπÌò∏ ÏäµÍ≤©", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 180%Ïùò Îç∞ÎØ∏ÏßÄ", cooldown: 8 },
          passives: [{ name: "Í∏âÏÜå Ìè¨Ï∞©", base: "Ï†Å HP 30% Ïù¥ÌïòÏùº Îïå ÎßπÌò∏ ÏäµÍ≤© Îç∞ÎØ∏ÏßÄ 40% Ï¶ùÍ∞Ä", enhanced: "Ï†Å HP 30% Ïù¥ÌïòÏùº Îïå ÎßπÌò∏ ÏäµÍ≤© Îç∞ÎØ∏ÏßÄ 70% Ï¶ùÍ∞Ä" }] },
        { active: { name: "Í∏âÍ∞ïÌïò", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 160%Ïùò Îç∞ÎØ∏ÏßÄ", cooldown: 7 },
          passives: [{ name: "ÏÑ†Ï†ú ÌÉÄÍ≤©", base: "Ï†ÑÌà¨ ÏãúÏûë ÌõÑ Ï≤´ Í∏âÍ∞ïÌïò ÏÇ¨Ïö© Ïãú ÏπòÎ™ÖÌÉÄ ÌôïÏ†ï", enhanced: "Ï†ÑÌà¨ ÏãúÏûë ÌõÑ Ï≤´ Í∏âÍ∞ïÌïò ÏÇ¨Ïö© Ïãú ÏπòÎ™ÖÌÉÄ ÌôïÏ†ï + Îç∞ÎØ∏ÏßÄ 30% Ï¶ùÍ∞Ä" }] },
        { active: { name: "ÌîºÏùò Í¥ëÎûÄ", desc: "4ÌÑ¥Í∞Ñ Í≥µÍ≤©ÏÜçÎèÑ 15% Ï¶ùÍ∞Ä", cooldown: 9 },
          passives: [{ name: "ÌîºÏùò Í∞àÏ¶ù", base: "ÌîºÏùò Í¥ëÎûÄ ÏßÄÏÜç Ï§ë ÌÇ¨ ÌöçÎìù Ïãú HP 8% ÌöåÎ≥µ", enhanced: "ÌîºÏùò Í¥ëÎûÄ ÏßÄÏÜç Ï§ë ÌÇ¨ ÌöçÎìù Ïãú HP 15% ÌöåÎ≥µ" }] },
        { active: { name: "Î®πÎ¨º Î∂ÑÏÇ¨", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê 2ÌÑ¥Í∞Ñ Î™ÖÏ§ëÎ•† 15% Í∞êÏÜå", cooldown: 10 },
          passives: [{ name: "Ïó∞Îßâ Ï†ÑÏà†", base: "Î®πÎ¨º Î∂ÑÏÇ¨ Ï†ÅÏ§ë Ïãú 25% ÌôïÎ•†Î°ú Ï£ºÏù∏Í≥µ Îã§Ïùå ÌîºÍ≤© Î¨¥Ìö®", enhanced: "Î®πÎ¨º Î∂ÑÏÇ¨ Ï†ÅÏ§ë Ïãú 40% ÌôïÎ•†Î°ú Ï£ºÏù∏Í≥µ Îã§Ïùå ÌîºÍ≤© Î¨¥Ìö®" }] },
      ],
      A: [
        { active: { name: "ÌôîÏóº Î∏åÎ†àÏä§", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 120%Ïùò ÌôîÏóº Îç∞ÎØ∏ÏßÄ", cooldown: 8 },
          passives: [{ name: "ÏûîÌôî", base: "ÌôîÏóº Î∏åÎ†àÏä§ Ï†ÅÏ§ë Ïãú 30% ÌôïÎ•†Î°ú 2ÌÑ¥Í∞Ñ ÌôîÏÉÅ (Îß§ ÌÑ¥ Í≥µÍ≤©Î†• 20% Îç∞ÎØ∏ÏßÄ)", enhanced: "ÌôîÏóº Î∏åÎ†àÏä§ Ï†ÅÏ§ë Ïãú 50% ÌôïÎ•†Î°ú 3ÌÑ¥Í∞Ñ ÌôîÏÉÅ (Îß§ ÌÑ¥ Í≥µÍ≤©Î†• 30% Îç∞ÎØ∏ÏßÄ)" }] },
        { active: { name: "Ïã†ÏÑ±Ìïú ÎèåÏßÑ", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 200%Ïùò Îç∞ÎØ∏ÏßÄ + HP 10% ÌöåÎ≥µ", cooldown: 9 },
          passives: [{ name: "Ï∂ïÎ≥µÏùò Îøî", base: "Ï£ºÏù∏Í≥µ HP 30% Ïù¥ÌïòÏùº Îïå Ïã†ÏÑ±Ìïú ÎèåÏßÑ ÌöåÎ≥µÎüâ 2Î∞∞", enhanced: "Ï£ºÏù∏Í≥µ HP 30% Ïù¥ÌïòÏùº Îïå Ïã†ÏÑ±Ìïú ÎèåÏßÑ ÌöåÎ≥µÎüâ 3Î∞∞ + Ïø®ÌÉÄÏûÑ 2 Í∞êÏÜå" }] },
        { active: { name: "ÏïîÌùë Ìè≠Î∞ú", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 100%Ïùò ÏïîÌùë Îç∞ÎØ∏ÏßÄ", cooldown: 7 },
          passives: [{ name: "ÏïºÌñâÏÑ±", base: "ÏïîÌùë Ìè≠Î∞úÎ°ú ÌÇ¨ ÌöçÎìù Ïãú Ï¶âÏãú Ïø®ÌÉÄÏûÑ Ï¥àÍ∏∞Ìôî (ÌÑ¥Îãπ 1Ìöå)", enhanced: "ÏïîÌùë Ìè≠Î∞úÎ°ú ÌÇ¨ ÌöçÎìù Ïãú Ï¶âÏãú Ïø®ÌÉÄÏûÑ Ï¥àÍ∏∞Ìôî (ÌÑ¥Îãπ 2Ìöå)" }] },
        { active: { name: "ÎèÖÏïÑ Î¨ºÍ∏∞", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 170%Ïùò ÎèÖ Îç∞ÎØ∏ÏßÄ + 3ÌÑ¥ Ï§ëÎèÖ", cooldown: 8 },
          passives: [{ name: "ÎßπÎèÖ ÌòàÍ¥Ä", base: "Ï§ëÎèÖÎêú Ï†Å ÌîºÍ≤© Ïãú 25% ÌôïÎ•†Î°ú Î∞òÍ≤© (Í≥µÍ≤©Î†• 60%)", enhanced: "Ï§ëÎèÖÎêú Ï†Å ÌîºÍ≤© Ïãú 40% ÌôïÎ•†Î°ú Î∞òÍ≤© (Í≥µÍ≤©Î†• 80%)" }] },
        { active: { name: "ÎèÖÏπ® ÎÇúÏÇ¨", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 60%Ïùò Îç∞ÎØ∏ÏßÄ x4Ìöå", cooldown: 9 },
          passives: [{ name: "Í∞ëÍ∞Å", base: "Ï£ºÏù∏Í≥µ HP 30% Ïù¥Ìïò ÏßÑÏûÖ Ïãú 1Ìöå Î¨¥Ï†Å + ÎèÖÏπ® ÎÇúÏÇ¨ Ïø®ÌÉÄÏûÑ Ï¥àÍ∏∞Ìôî", enhanced: "Ï£ºÏù∏Í≥µ HP 30% Ïù¥Ìïò ÏßÑÏûÖ Ïãú 1Ìöå Î¨¥Ï†Å + ÎèÖÏπ® ÎÇúÏÇ¨ Ï¶âÏãú Î∞úÎèô" }] },
        { active: { name: "Ïã¨Ìï¥ Ìè¨Ïòπ", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 180%Ïùò Îç∞ÎØ∏ÏßÄ + 2ÌÑ¥ ÏÜçÎ∞ï", cooldown: 10 },
          passives: [{ name: "Ìù°Ï∞©", base: "ÏÜçÎ∞ïÎêú Ï†Å Í≥µÍ≤© Ïãú 30% ÌôïÎ•†Î°ú Í∞ôÏù¥ Í≥µÍ≤© (Í≥µÍ≤©Î†• 40%)", enhanced: "ÏÜçÎ∞ïÎêú Ï†Å Í≥µÍ≤© Ïãú 50% ÌôïÎ•†Î°ú Í∞ôÏù¥ Í≥µÍ≤© (Í≥µÍ≤©Î†• 60%)" }] },
        { active: { name: "Ìï¥Î•ò Ï∂©Í≤©Ìåå", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 130%Ïùò ÏàòÏÜçÏÑ± Îç∞ÎØ∏ÏßÄ", cooldown: 9 },
          passives: [{ name: "ÌååÎèÑÏùò Ïó∞ÏáÑ", base: "Ìï¥Î•ò Ï∂©Í≤©Ìåå ÌÇ¨ Ïãú ÎÇòÎ®∏ÏßÄ Ï†ÅÏóêÍ≤å Ï∂îÍ∞Ä 50% Îç∞ÎØ∏ÏßÄ", enhanced: "Ìï¥Î•ò Ï∂©Í≤©Ìåå ÌÇ¨ Ïãú ÎÇòÎ®∏ÏßÄ Ï†ÅÏóêÍ≤å Ï∂îÍ∞Ä 80% Îç∞ÎØ∏ÏßÄ + 1ÌÑ¥ Í∞êÏÜç" }] },
        { active: { name: "ÎèåÏßÑ", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 220%Ïùò Îç∞ÎØ∏ÏßÄ", cooldown: 10 },
          passives: [{ name: "Î∂àÍµ¥", base: "Ï£ºÏù∏Í≥µ HP 50% Ïù¥ÌïòÏùº Îïå ÎèåÏßÑ Îç∞ÎØ∏ÏßÄ 40% Ï¶ùÍ∞Ä", enhanced: "Ï£ºÏù∏Í≥µ HP 50% Ïù¥ÌïòÏùº Îïå ÎèåÏßÑ Îç∞ÎØ∏ÏßÄ 60% Ï¶ùÍ∞Ä + Í¥ÄÌÜµ" }] },
      ],
      S: [
        { active: { name: "ÌôîÏóº Ïã¨Ìåê", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 200%Ïùò ÌôîÏóº Îç∞ÎØ∏ÏßÄ + 3ÌÑ¥ ÌôîÏÉÅ", cooldown: 8 },
          passives: [
            { name: "Î∂àÍΩÉ Í∞ëÏò∑", base: "Ï£ºÏù∏Í≥µ ÌîºÍ≤© Ïãú 20% ÌôïÎ•†Î°ú Í≥µÍ≤©ÏûêÏóêÍ≤å Î∞òÍ≤© (ÌôîÏóº Ïã¨Ìåê Í≥µÍ≤©Î†• 30%)", enhanced: "Ï£ºÏù∏Í≥µ ÌîºÍ≤© Ïãú 35% ÌôïÎ•†Î°ú Í≥µÍ≤©ÏûêÏóêÍ≤å Î∞òÍ≤© (ÌôîÏóº Ïã¨Ìåê Í≥µÍ≤©Î†• 50%)" },
            { name: "Ïó∞ÏÜå Ìè≠Î∞ú", base: "ÌôîÏÉÅ ÏÉÅÌÉúÏùò Ï†Å 3ÎßàÎ¶¨ Ïù¥ÏÉÅÏùº Îïå ÌôîÏóº Ïã¨Ìåê Îç∞ÎØ∏ÏßÄ 30% Ï¶ùÍ∞Ä", enhanced: "ÌôîÏÉÅ ÏÉÅÌÉúÏùò Ï†Å 3ÎßàÎ¶¨ Ïù¥ÏÉÅÏùº Îïå ÌôîÏóº Ïã¨Ìåê Îç∞ÎØ∏ÏßÄ 50% Ï¶ùÍ∞Ä + Ïø®ÌÉÄÏûÑ 1 Í∞êÏÜå" }] },
        { active: { name: "Ï†àÎåÄÏòÅÎèÑ", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 180%Ïùò ÎπôÍ≤∞ Îç∞ÎØ∏ÏßÄ + 30% ÌôïÎ•†Î°ú ÎèôÍ≤∞", cooldown: 9 },
          passives: [
            { name: "ÎèôÍ≤∞ Ïó∞ÏáÑ", base: "ÎèôÍ≤∞Îêú Ï†Å ÌîºÍ≤© Ïãú 25% ÌôïÎ•†Î°ú Ïù∏Ï†ë Ï†ÅÎèÑ ÎèôÍ≤∞ 1ÌÑ¥", enhanced: "ÎèôÍ≤∞Îêú Ï†Å ÌîºÍ≤© Ïãú 40% ÌôïÎ•†Î°ú Ïù∏Ï†ë Ï†ÅÎèÑ ÎèôÍ≤∞ 1ÌÑ¥" },
            { name: "ÎπôÍ≤∞Ìïµ", base: "ÎèôÍ≤∞Ïù¥ ÌíÄÎ¶¥ Îïå Ìï¥Îãπ Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 100%Ïùò Ï∂îÍ∞Ä ÎπôÍ≤∞ Îç∞ÎØ∏ÏßÄ", enhanced: "ÎèôÍ≤∞Ïù¥ ÌíÄÎ¶¥ Îïå Ìï¥Îãπ Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 160%Ïùò Ï∂îÍ∞Ä ÎπôÍ≤∞ Îç∞ÎØ∏ÏßÄ" }] },
        { active: { name: "Ï≤úÎë• Í∞ïÌÉÄ", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 300%Ïùò Î≤àÍ∞ú Îç∞ÎØ∏ÏßÄ", cooldown: 7 },
          passives: [
            { name: "Ï†ÑÎ•ò", base: "Ï£ºÏù∏Í≥µ Í≥µÍ≤© Ïãú 25% ÌôïÎ•†Î°ú Í∞ôÏù¥ Í≥µÍ≤© (Í≥µÍ≤©Î†• 40%)", enhanced: "Ï£ºÏù∏Í≥µ Í≥µÍ≤© Ïãú 35% ÌôïÎ•†Î°ú Í∞ôÏù¥ Í≥µÍ≤© (Í≥µÍ≤©Î†• 60%)" },
            { name: "Í≥ºÎ∂ÄÌïò", base: "Ï≤úÎë• Í∞ïÌÉÄ ÏπòÎ™ÖÌÉÄ Ïãú Îã§Ïùå ÌÑ¥ Ï£ºÏù∏Í≥µ Í≥µÍ≤©Ïóê Î≤àÍ∞ú Ï∂îÍ∞Ä Îç∞ÎØ∏ÏßÄ 50%", enhanced: "Ï≤úÎë• Í∞ïÌÉÄ ÏπòÎ™ÖÌÉÄ Ïãú Îã§Ïùå 2ÌÑ¥ Ï£ºÏù∏Í≥µ Í≥µÍ≤©Ïóê Î≤àÍ∞ú Ï∂îÍ∞Ä Îç∞ÎØ∏ÏßÄ 80%" }] },
        { active: { name: "Ìï¥Ïùº", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 160%Ïùò ÏàòÏÜçÏÑ± Îç∞ÎØ∏ÏßÄ + HP 15% ÌöåÎ≥µ", cooldown: 10 },
          passives: [
            { name: "Ïû¨ÏÉùÏùò Î¨ºÍ≤∞", base: "Ìï¥Ïùº Î∞úÎèô Ïãú 3ÌÑ¥Í∞Ñ Îß§ ÌÑ¥ HP 3% Ï∂îÍ∞Ä ÌöåÎ≥µ", enhanced: "Ìï¥Ïùº Î∞úÎèô Ïãú 5ÌÑ¥Í∞Ñ Îß§ ÌÑ¥ HP 5% Ï∂îÍ∞Ä ÌöåÎ≥µ" },
            { name: "ÏàòÏïï", base: "Ï£ºÏù∏Í≥µÏù¥ ÌöåÎ≥µÎê† Îïå 30% ÌôïÎ•†Î°ú Ìï¥Ïùº Ïø®ÌÉÄÏûÑ 1 Í∞êÏÜå", enhanced: "Ï£ºÏù∏Í≥µÏù¥ ÌöåÎ≥µÎê† Îïå 45% ÌôïÎ•†Î°ú Ìï¥Ïùº Ïø®ÌÉÄÏûÑ 2 Í∞êÏÜå" }] },
        { active: { name: "ÏïîÌùë Ï∞∏Í≤©", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 280%Ïùò ÏïîÌùë Îç∞ÎØ∏ÏßÄ + Ìù°Ìòà 20%", cooldown: 8 },
          passives: [
            { name: "Ïñ¥Îë†Ïùò ÏπºÎÇ†", base: "ÏïîÌùë Ï∞∏Í≤© ÌÇ¨ Ïãú Ìù°ÌòàÎüâ HP 15% Ï∂îÍ∞Ä ÌöåÎ≥µ", enhanced: "ÏïîÌùë Ï∞∏Í≤© ÌÇ¨ Ïãú Ìù°ÌòàÎüâ HP 25% Ï∂îÍ∞Ä ÌöåÎ≥µ + Ïø®ÌÉÄÏûÑ 2 Í∞êÏÜå" },
            { name: "Í≥µÌè¨", base: "ÏïîÌùë Ï∞∏Í≤© ÌîºÍ≤© ÎåÄÏÉÅ 20% ÌôïÎ•†Î°ú 2ÌÑ¥Í∞Ñ Í≥µÌè¨ (Í≥µÍ≤©Î†• 30% Í∞êÏÜå)", enhanced: "ÏïîÌùë Ï∞∏Í≤© ÌîºÍ≤© ÎåÄÏÉÅ 35% ÌôïÎ•†Î°ú 2ÌÑ¥Í∞Ñ Í≥µÌè¨ (Í≥µÍ≤©Î†• 50% Í∞êÏÜå)" }] },
        { active: { name: "ÌÉúÏñë ÏÑ¨Í¥ë", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 190%Ïùò Í¥ëÏÜçÏÑ± Îç∞ÎØ∏ÏßÄ + Ïã§Î™Ö 2ÌÑ¥", cooldown: 9 },
          passives: [
            { name: "ÏùºÍ¥ë Ï∂©Ï†Ñ", base: "ÌÉúÏñë ÏÑ¨Í¥ë ÎØ∏ÏÇ¨Ïö© 3ÌÑ¥ Í≤ΩÍ≥º Ïãú Îã§Ïùå Î∞úÎèô Îç∞ÎØ∏ÏßÄ 50% Ï¶ùÍ∞Ä", enhanced: "ÌÉúÏñë ÏÑ¨Í¥ë ÎØ∏ÏÇ¨Ïö© 3ÌÑ¥ Í≤ΩÍ≥º Ïãú Îã§Ïùå Î∞úÎèô Îç∞ÎØ∏ÏßÄ 80% Ï¶ùÍ∞Ä + Ïã§Î™Ö 3ÌÑ¥" },
            { name: "ÎπõÏùò Ïã¨Ìåê", base: "Ïã§Î™Ö ÏÉÅÌÉúÏùò Ï†Å Í≥µÍ≤© Ïãú 30% ÌôïÎ•†Î°ú Ï£ºÏù∏Í≥µÍ≥º Ìï®Íªò ÌòëÍ≥µ", enhanced: "Ïã§Î™Ö ÏÉÅÌÉúÏùò Ï†Å Í≥µÍ≤© Ïãú 45% ÌôïÎ•†Î°ú Ï£ºÏù∏Í≥µÍ≥º Ìï®Íªò ÌòëÍ≥µ" }] },
        { active: { name: "Îã§Ïù¥ÏïÑ Î∞©Î≤Ω", desc: "5ÌÑ¥Í∞Ñ Î∞õÎäî Îç∞ÎØ∏ÏßÄ 40% Í∞êÏÜå", cooldown: 12 },
          passives: [
            { name: "Í≤∞Ï†ï Î∞òÏÇ¨", base: "Îã§Ïù¥ÏïÑ Î∞©Î≤Ω ÏßÄÏÜç Ï§ë ÌîºÍ≤© Ïãú 25% ÌôïÎ•†Î°ú Îç∞ÎØ∏ÏßÄ 50% Î∞òÏÇ¨", enhanced: "Îã§Ïù¥ÏïÑ Î∞©Î≤Ω ÏßÄÏÜç Ï§ë ÌîºÍ≤© Ïãú 40% ÌôïÎ•†Î°ú Îç∞ÎØ∏ÏßÄ 70% Î∞òÏÇ¨" },
            { name: "Î≥¥ÏÑù Í≥µÎ™Ö", base: "Îã§Ïù¥ÏïÑ Î∞©Î≤Ω Ï¢ÖÎ£å Ïãú 30% ÌôïÎ•†Î°ú Ïø®ÌÉÄÏûÑ Ï¶âÏãú 4 Í∞êÏÜå", enhanced: "Îã§Ïù¥ÏïÑ Î∞©Î≤Ω Ï¢ÖÎ£å Ïãú 50% ÌôïÎ•†Î°ú Ïø®ÌÉÄÏûÑ Ï¶âÏãú 6 Í∞êÏÜå" }] },
        { active: { name: "ÏõîÍ¥ë Ï∞∏Í≤©", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 260%Ïùò Îç∞ÎØ∏ÏßÄ (Î∞§Ïóê 50% Ï∂îÍ∞Ä)", cooldown: 8 },
          passives: [
            { name: "Îã¨Ïùò Ïù∏ÎèÑ", base: "Ï£ºÏù∏Í≥µ ÌöåÌîº ÏÑ±Í≥µ Ïãú ÏõîÍ¥ë Ï∞∏Í≤© Îã§Ïùå Î∞úÎèô Îç∞ÎØ∏ÏßÄ 30% Ï¶ùÍ∞Ä (ÎàÑÏ†Å 2Ìöå)", enhanced: "Ï£ºÏù∏Í≥µ ÌöåÌîº ÏÑ±Í≥µ Ïãú ÏõîÍ¥ë Ï∞∏Í≤© Îã§Ïùå Î∞úÎèô Îç∞ÎØ∏ÏßÄ 40% Ï¶ùÍ∞Ä (ÎàÑÏ†Å 3Ìöå)" },
            { name: "ÏõîÏãù", base: "ÏõîÍ¥ë Ï∞∏Í≤© ÏπòÎ™ÖÌÉÄ Ïãú ÎåÄÏÉÅÏùò Ïä§ÌÇ¨ Ïø®ÌÉÄÏûÑ 2 Ï¶ùÍ∞Ä", enhanced: "ÏõîÍ¥ë Ï∞∏Í≤© ÏπòÎ™ÖÌÉÄ Ïãú ÎåÄÏÉÅÏùò Ïä§ÌÇ¨ Ïø®ÌÉÄÏûÑ 3 Ï¶ùÍ∞Ä + 2ÌÑ¥ ÏïîÌùë" }] },
        { active: { name: "Ìè≠Ìíç ÏßàÏ£º", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 150%Ïùò Îç∞ÎØ∏ÏßÄ x3Ìöå", cooldown: 8 },
          passives: [
            { name: "ÏßàÌíç Ïó∞ÌÉÄ", base: "Ìè≠Ìíç ÏßàÏ£º Í∞Å ÌÉÄÍ≤© Ïãú 20% ÌôïÎ•†Î°ú Ï∂îÍ∞Ä 1Ìöå ÌÉÄÍ≤©", enhanced: "Ìè≠Ìíç ÏßàÏ£º Í∞Å ÌÉÄÍ≤© Ïãú 35% ÌôïÎ•†Î°ú Ï∂îÍ∞Ä 1Ìöå ÌÉÄÍ≤©" },
            { name: "ÎÇúÍ∏∞Î•ò", base: "Ìè≠Ìíç ÏßàÏ£º 3ÌÉÄ Î™®Îëê Ï†ÅÏ§ë Ïãú Ï£ºÏù∏Í≥µ Îã§Ïùå ÌîºÍ≤© ÌöåÌîº ÌôïÏ†ï", enhanced: "Ìè≠Ìíç ÏßàÏ£º 3ÌÉÄ Î™®Îëê Ï†ÅÏ§ë Ïãú Ï£ºÏù∏Í≥µ Îã§Ïùå ÌîºÍ≤© ÌöåÌîº ÌôïÏ†ï + Ïø®ÌÉÄÏûÑ 2 Í∞êÏÜå" }] },
        { active: { name: "Ïú†ÏÑ± Ï∂©Îèå", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 250%Ïùò Îç∞ÎØ∏ÏßÄ", cooldown: 11 },
          passives: [
            { name: "ÎåÄÍ∏∞Í∂å ÏßÑÏûÖ", base: "Ïú†ÏÑ± Ï∂©Îèå Î∞úÎèô Ïãú Îã§Ïùå Ï£ºÏù∏Í≥µ Í≥µÍ≤© ÏπòÎ™ÖÌÉÄ ÌôïÏ†ï", enhanced: "Ïú†ÏÑ± Ï∂©Îèå Î∞úÎèô Ïãú Îã§Ïùå 2Ìöå Ï£ºÏù∏Í≥µ Í≥µÍ≤© ÏπòÎ™ÖÌÉÄ ÌôïÏ†ï" },
            { name: "Ïö¥ÏÑù ÌååÌé∏", base: "Ïú†ÏÑ± Ï∂©Îèå ÌÇ¨ Ïãú 15% ÌôïÎ•†Î°ú Í∞ôÏùÄ ÏúÑÎ†•Ïùò Ïú†ÏÑ±Ïù¥ ÌïúÎ≤à Îçî ÎÇôÌïò", enhanced: "Ïú†ÏÑ± Ï∂©Îèå ÌÇ¨ Ïãú 30% ÌôïÎ•†Î°ú Í∞ôÏùÄ ÏúÑÎ†•Ïùò Ïú†ÏÑ±Ïù¥ ÌïúÎ≤à Îçî ÎÇôÌïò" }] },
        { active: { name: "ÍΩÉÎπÑ", desc: "ÏïÑÍµ∞ Ï†ÑÏ≤¥ HP 20% ÌöåÎ≥µ + 3ÌÑ¥Í∞Ñ Í≥µÍ≤©Î†• 10% Ï¶ùÍ∞Ä", cooldown: 10 },
          passives: [
            { name: "ÍΩÉÏûé Î≥¥Ìò∏", base: "ÍΩÉÎπÑ ÏßÄÏÜç Ï§ë Ï£ºÏù∏Í≥µ ÌîºÍ≤© Ïãú 20% ÌôïÎ•†Î°ú ÌîºÌï¥ Ìù°Ïàò ÌõÑ HPÎ°ú Ï†ÑÌôò", enhanced: "ÍΩÉÎπÑ ÏßÄÏÜç Ï§ë Ï£ºÏù∏Í≥µ ÌîºÍ≤© Ïãú 35% ÌôïÎ•†Î°ú ÌîºÌï¥ Ìù°Ïàò ÌõÑ HPÎ°ú Ï†ÑÌôò" },
            { name: "Î¥ÑÏùò Í∏∞Ïö¥", base: "ÍΩÉÎπÑÎ°ú HPÍ∞Ä ÏµúÎåÄÏπò ÎèÑÎã¨ Ïãú Ï¥àÍ≥º ÌöåÎ≥µÎüâÏùò 50%Î•º Î≥¥Ìò∏ÎßâÏúºÎ°ú Ï†ÑÌôò", enhanced: "ÍΩÉÎπÑÎ°ú HPÍ∞Ä ÏµúÎåÄÏπò ÎèÑÎã¨ Ïãú Ï¥àÍ≥º ÌöåÎ≥µÎüâÏùò 80%Î•º Î≥¥Ìò∏ÎßâÏúºÎ°ú Ï†ÑÌôò" }] },
        { active: { name: "Î≥ÑÏùò Í∞ÄÌò∏", desc: "ÏïÑÍµ∞ Ï†ÑÏ≤¥ 5ÌÑ¥Í∞Ñ Î∞õÎäî Îç∞ÎØ∏ÏßÄ 25% Í∞êÏÜå", cooldown: 12 },
          passives: [
            { name: "Î≥ÑÎπõ Î≥¥Ìò∏Îßâ", base: "Î≥ÑÏùò Í∞ÄÌò∏ Î∞úÎèô Ïãú Ï£ºÏù∏Í≥µÏóêÍ≤å HP 10%Ïùò Î≥¥Ìò∏Îßâ Ï∂îÍ∞Ä ÏÉùÏÑ±", enhanced: "Î≥ÑÏùò Í∞ÄÌò∏ Î∞úÎèô Ïãú Ï£ºÏù∏Í≥µÏóêÍ≤å HP 18%Ïùò Î≥¥Ìò∏Îßâ Ï∂îÍ∞Ä ÏÉùÏÑ±" },
            { name: "ÏÑ±Í¥ë Ìè≠Î∞ú", base: "Î≥ÑÏùò Í∞ÄÌò∏ ÏßÄÏÜç Ï§ë Î≥¥Ìò∏Îßâ ÌååÍ¥¥ Ïãú Ï†Å Ï†ÑÏ≤¥Ïóê ÌååÍ¥¥Îêú Î≥¥Ìò∏ÎßâÏùò 200% Îç∞ÎØ∏ÏßÄ", enhanced: "Î≥ÑÏùò Í∞ÄÌò∏ ÏßÄÏÜç Ï§ë Î≥¥Ìò∏Îßâ ÌååÍ¥¥ Ïãú Ï†Å Ï†ÑÏ≤¥Ïóê ÌååÍ¥¥Îêú Î≥¥Ìò∏ÎßâÏùò 350% Îç∞ÎØ∏ÏßÄ" }] },
      ],
      SS: [
        { active: { name: "Î∂àÎ©∏Ïùò Î∂àÍΩÉ", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 350%Ïùò ÌôîÏóº Îç∞ÎØ∏ÏßÄ + HP 1Ïùº Îïå Î∂ÄÌôú 1Ìöå", cooldown: 10 },
          passives: [
            { name: "ÌîºÎãâÏä§Ïùò ÍπÉÌÑ∏", base: "Ï£ºÏù∏Í≥µ ÏÇ¨Îßù Ïãú 1Ìöå HP 30%Î°ú Î∂ÄÌôú + Î∂àÎ©∏Ïùò Î∂àÍΩÉ Ï¶âÏãú Î∞úÎèô" },
            { name: "ÏòÅÏõêÌïú ÌôîÏóº", base: "Î∂àÎ©∏Ïùò Î∂àÍΩÉÏúºÎ°ú ÌôîÏÉÅ Î∂ÄÏó¨ Ïãú Ìï¥Îãπ ÌôîÏÉÅÏùÄ Ìï¥Ï†ú Î∂àÍ∞Ä + Îß§ ÌÑ¥ Îç∞ÎØ∏ÏßÄ 10%Ïî© Ï¶ùÍ∞Ä" }] },
        { active: { name: "ÎπôÌïòÍ∏∞", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 300%Ïùò ÎπôÍ≤∞ Îç∞ÎØ∏ÏßÄ + 50% ÌôïÎ•†Î°ú ÎèôÍ≤∞ 2ÌÑ¥", cooldown: 10 },
          passives: [
            { name: "ÏòÅÍµ¨ ÎèôÌÜ†", base: "ÎèôÍ≤∞Îêú Ï†Å ÏÇ¨Îßù Ïãú Ïù∏Ï†ë Ï†ÅÏóêÍ≤å ÎèôÍ≤∞ Ï†ÑÏù¥ + Í≥µÍ≤©Î†• 80%Ïùò ÎπôÍ≤∞ Ìè≠Î∞ú" },
            { name: "Í∑πÏ†ÄÏò® Ïû•Îßâ", base: "ÎπôÌïòÍ∏∞ Î∞úÎèô ÌõÑ 3ÌÑ¥Í∞Ñ Ï£ºÏù∏Í≥µ ÌîºÍ≤© Ïãú Í≥µÍ≤©Ïûê 30% ÌôïÎ•†Î°ú ÎèôÍ≤∞ 1ÌÑ¥" }] },
        { active: { name: "ÎáåÏ†úÏùò Ïã¨Ìåê", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 500%Ïùò Î≤àÍ∞ú Îç∞ÎØ∏ÏßÄ (ÏπòÎ™ÖÌÉÄ Ïãú 2Î∞∞)", cooldown: 9 },
          passives: [
            { name: "Î≤àÍ∞ú Î∞òÏÇ¨", base: "Ï£ºÏù∏Í≥µ ÌîºÍ≤© Ïãú 40% ÌôïÎ•†Î°ú Í≥µÍ≤©ÏûêÏóêÍ≤å Î≤àÍ∞ú Î∞òÍ≤© (Í≥µÍ≤©Î†• 80%)" },
            { name: "Ï≤úÎë•Ïùò ÏôïÍ¥Ä", base: "ÎáåÏ†úÏùò Ïã¨Ìåê 3Ìöå ÏÇ¨Ïö©ÎßàÎã§ Îã§Ïùå Î∞úÎèô Ïãú Ï†ÑÏ≤¥ Í≥µÍ≤©ÏúºÎ°ú Î≥ÄÍ≤Ω + Îç∞ÎØ∏ÏßÄ 50% Ï¶ùÍ∞Ä" }] },
        { active: { name: "Ïã¨Ïó∞Ïùò ÌååÎèÑ", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 280%Ïùò Îç∞ÎØ∏ÏßÄ + HP 25% ÌöåÎ≥µ + ÏÜçÎ∞ï 2ÌÑ¥", cooldown: 11 },
          passives: [
            { name: "Ïã¨Ìï¥Ïùò Í∂åÎä•", base: "Ïã¨Ïó∞Ïùò ÌååÎèÑ ÌöåÎ≥µÎüâÏùò 30%Î•º Îã§Ïùå ÌÑ¥ÍπåÏßÄ Î≥¥Ìò∏ÎßâÏúºÎ°ú Ïú†ÏßÄ" },
            { name: "ÎÇòÎùΩ", base: "ÏÜçÎ∞ï ÏÉÅÌÉúÏùò Ï†Å Í≥µÍ≤© Ïãú Î∞©Ïñ¥Î†• ÏôÑÏ†Ñ Î¨¥Ïãú + 35% ÌôïÎ•†Î°ú Í∞ôÏù¥ Í≥µÍ≤©" }] },
        { active: { name: "Ï≤úÏÉÅÏùò Ïã¨Ìåê", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 320%Ïùò Í¥ëÏÜçÏÑ± Îç∞ÎØ∏ÏßÄ + ÏïÑÍµ∞ Ï†ÑÏ≤¥ HP 15% ÌöåÎ≥µ", cooldown: 10 },
          passives: [
            { name: "Ïã†ÏÑ±Ìïú Î≥¥Ìò∏Îßâ", base: "Ï≤úÏÉÅÏùò Ïã¨Ìåê Î∞úÎèô Ïãú Ï£ºÏù∏Í≥µÏóêÍ≤å HP 20%Ïùò Ïã†ÏÑ± Î≥¥Ìò∏Îßâ (3ÌÑ¥ ÏßÄÏÜç)" },
            { name: "Ï≤úÏÇ¨Ïùò Ï∂ïÎ≥µ", base: "Ï£ºÏù∏Í≥µ HP 1% ÎèÑÎã¨ Ïãú 1Ìöå Ï¶âÏãú HP 50% ÌöåÎ≥µ + Ï≤úÏÉÅÏùò Ïã¨Ìåê Ïø®ÌÉÄÏûÑ Ï¥àÍ∏∞Ìôî" }] },
        { active: { name: "ÏÑ±Ïö¥ Ìè≠Î∞ú", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 400%Ïùò Îç∞ÎØ∏ÏßÄ + Î™®Îì† ÎîîÎ≤ÑÌîÑ Ìï¥Ï†ú", cooldown: 12 },
          passives: [
            { name: "Ïö∞Ï£ºÏùò ÏùòÏßÄ", base: "ÏÑ±Ïö¥ Ìè≠Î∞úÎ°ú ÎîîÎ≤ÑÌîÑ Ìï¥Ï†ú Ïãú Ìï¥Ï†úÎêú ÎîîÎ≤ÑÌîÑ Ïàò √ó1ÌÑ¥ÎßåÌÅº Î™®Îì† Ìé´ Ïø®ÌÉÄÏûÑ Í∞êÏÜå" },
            { name: "Î≥ÑÏùò ÏÜåÎ©∏", base: "ÏÑ±Ïö¥ Ìè≠Î∞ú ÌÇ¨ Ïãú Ï≤òÏπòÌïú Ï†Å ÏàòÎßåÌÅº Îã§Ïùå Î∞úÎèô Îç∞ÎØ∏ÏßÄ 20%Ïî© Ï¶ùÍ∞Ä (ÏµúÎåÄ 100%)" }] },
      ],
    };

    function createInitialInventory() {
      const inv = {};
      GRADES.forEach((g) => {
        const count = PET_NAMES[g].length;
        for (let i = 0; i < count; i++) {
          inv[`${g}_${i}`] = { grade: g, idx: i, copies: [] };
        }
      });
      return inv;
    }

    function pullOne() {
      const r = Math.random();
      let cum = 0;
      for (const [grade, rate] of Object.entries(PULL_RATES)) {
        cum += rate;
        if (r < cum) {
          const idx = Math.floor(Math.random() * PET_NAMES[grade].length);
          return { grade, idx };
        }
      }
      return { grade: "C", idx: 0 };
    }

    // ============================================================
    // COMPONENTS
    // ============================================================

    const GradeBadge = ({ grade, size = "sm" }) => {
      const c = GRADE_COLORS[grade];
      const sizes = { xs: "16px", sm: "20px", md: "26px", lg: "34px" };
      const fontSizes = { xs: "9px", sm: "11px", md: "14px", lg: "17px" };
      return React.createElement("span", {
        style: {
          display: "inline-flex", alignItems: "center", justifyContent: "center",
          width: sizes[size], height: sizes[size], borderRadius: "4px",
          background: c.bg, color: c.text, fontSize: fontSizes[size],
          fontWeight: 800, letterSpacing: "0.5px",
          boxShadow: `0 0 8px ${c.glow}`,
        }
      }, grade);
    };

    const PetCard = ({ grade, idx, enhanceLevel = 0, count, onClick, selected, compact, hideEnhance }) => {
      const c = GRADE_COLORS[grade];
      const emoji = PET_EMOJIS[grade][idx];
      const name = PET_NAMES[grade][idx];
      const maxEnh = MAX_ENHANCE[grade];
      const isMax = enhanceLevel >= maxEnh;
      const canEnhanceGrade = maxEnh > 0;
      const showEnhance = canEnhanceGrade && !hideEnhance;

      return React.createElement("div", {
        onClick,
        style: {
          position: "relative",
          width: compact ? "80px" : "96px",
          padding: compact ? "7px 5px" : "9px 7px",
          borderRadius: "10px",
          background: `linear-gradient(145deg, ${c.bg}22, ${c.bg}44)`,
          border: selected ? `2px solid ${c.accent}` : `1px solid ${c.bg}55`,
          cursor: onClick ? "pointer" : "default",
          transition: "all 0.2s",
          textAlign: "center",
          boxShadow: selected ? `0 0 16px ${c.glow}` : "none",
          flexShrink: 0,
        }
      },
        React.createElement("div", { style: { fontSize: compact ? "28px" : "36px", lineHeight: 1 } }, emoji),
        React.createElement("div", {
          style: { fontSize: "15px", color: c.text, marginTop: "3px", fontWeight: 600, whiteSpace: "nowrap", overflow: "hidden", textOverflow: "ellipsis" }
        }, name),
        React.createElement("div", {
          style: { display: "flex", gap: "3px", justifyContent: "center", marginTop: "3px", alignItems: "center" }
        },
          React.createElement(GradeBadge, { grade, size: "xs" }),
          showEnhance && React.createElement("span", {
            style: { fontSize: "15px", color: isMax ? "#48bb78" : "#a0aec0", fontWeight: 700 }
          }, isMax ? "MAX" : `+${enhanceLevel}/${maxEnh}`)
        ),
        count > 1 && React.createElement("div", {
          style: {
            position: "absolute", top: "-4px", right: "-4px",
            background: "#e53e3e", color: "#fff", fontSize: "15px", fontWeight: 800,
            borderRadius: "8px", padding: "1px 5px", minWidth: "16px", textAlign: "center",
          }
        }, `√ó${count}`)
      );
    };

    // Pull animation - 2 phases: results then enhance summary
    const PullReveal = ({ results, onClose }) => {
      const [revealedCount, setRevealedCount] = useState(0);
      const [showAll, setShowAll] = useState(false);
      const [phase, setPhase] = useState("pull"); // "pull" or "enhance"

      const enhancedPets = useMemo(() => {
        const map = {};
        results.forEach((r) => {
          if (r.leveledUp) {
            const key = `${r.grade}_${r.idx}`;
            if (!map[key]) {
              map[key] = { grade: r.grade, idx: r.idx, levels: [] };
            }
            map[key].levels.push(r.newLevel);
          }
        });
        // Sort levels and show final level with count
        return Object.values(map).map((p) => ({
          ...p,
          finalLevel: Math.max(...p.levels),
          count: p.levels.length,
        }));
      }, [results]);

      useEffect(() => {
        if (phase !== "pull" || showAll) return;
        if (revealedCount < results.length) {
          const t = setTimeout(() => setRevealedCount((c) => c + 1), 200);
          return () => clearTimeout(t);
        }
      }, [revealedCount, results.length, showAll, phase]);

      const handleClick = () => {
        if (phase === "pull") {
          if (revealedCount < results.length) {
            setShowAll(true);
            setRevealedCount(results.length);
          } else if (enhancedPets.length > 0) {
            setPhase("enhance");
          } else {
            onClose();
          }
        } else {
          onClose();
        }
      };

      const displayed = showAll ? results : results.slice(0, revealedCount);

      if (phase === "enhance") {
        return React.createElement("div", {
          onClick: handleClick,
          style: {
            position: "fixed", inset: 0, zIndex: 1000,
            background: "rgba(0,0,0,0.88)", display: "flex", flexDirection: "column",
            alignItems: "center", justifyContent: "center", gap: "20px",
          }
        },
          React.createElement("div", {
            style: { color: "#f6e05e", fontSize: "18px", fontWeight: 700, fontFamily: "'Noto Sans KR', sans-serif" }
          }, "‚¨Ü Í∞ïÌôî Í≤∞Í≥º"),
          React.createElement("div", {
            style: { display: "flex", flexWrap: "wrap", gap: "12px", justifyContent: "center", maxWidth: "420px", padding: "0 16px" }
          },
            ...enhancedPets.map((p, i) => {
              const c = GRADE_COLORS[p.grade];
              const maxEnh = MAX_ENHANCE[p.grade];
              const isMax = p.finalLevel >= maxEnh;
              return React.createElement("div", {
                key: i,
                style: {
                  animation: "popIn 0.4s ease-out",
                  animationDelay: `${i * 0.1}s`,
                  animationFillMode: "both",
                  display: "flex", flexDirection: "column", alignItems: "center",
                  padding: "10px 14px", borderRadius: "12px",
                  background: isMax
                    ? `linear-gradient(145deg, rgba(72,187,120,0.15), rgba(72,187,120,0.05))`
                    : `linear-gradient(145deg, ${c.bg}22, ${c.bg}44)`,
                  border: isMax ? "1px solid rgba(72,187,120,0.4)" : `1px solid ${c.bg}55`,
                  minWidth: "90px",
                }
              },
                React.createElement("div", { style: { fontSize: "36px", lineHeight: 1 } }, PET_EMOJIS[p.grade][p.idx]),
                React.createElement("div", {
                  style: { fontSize: "15px", color: c.text, marginTop: "4px", fontWeight: 600 }
                }, PET_NAMES[p.grade][p.idx]),
                React.createElement("div", {
                  style: { display: "flex", alignItems: "center", gap: "4px", marginTop: "6px" }
                },
                  React.createElement(GradeBadge, { grade: p.grade, size: "xs" }),
                  React.createElement("span", {
                    style: {
                      fontSize: "15px", fontWeight: 800,
                      color: isMax ? "#48bb78" : "#f6e05e",
                    }
                  }, isMax ? `Lv.MAX!` : `Lv.${p.finalLevel}`)
                ),
                isMax && React.createElement("div", {
                  style: {
                    marginTop: "4px", fontSize: "15px", fontWeight: 700,
                    color: "#48bb78", animation: "pulse 1s ease-in-out infinite",
                  }
                }, "‚ú® Ìï©ÏÑ± Í∞ÄÎä•!")
              );
            })
          ),
          React.createElement("div", {
            style: { color: "#a0aec0", fontSize: "15px", fontFamily: "'Noto Sans KR', sans-serif" }
          }, "ÌÉ≠ÌïòÏó¨ Îã´Í∏∞")
        );
      }

      return React.createElement("div", {
        onClick: handleClick,
        style: {
          position: "fixed", inset: 0, zIndex: 1000,
          background: "rgba(0,0,0,0.88)", display: "flex", flexDirection: "column",
          alignItems: "center", justifyContent: "center", gap: "20px",
        }
      },
        React.createElement("div", {
          style: { color: "#fff", fontSize: "18px", fontWeight: 700, fontFamily: "'Noto Sans KR', sans-serif" }
        }, "üé∞ ÎΩëÍ∏∞ Í≤∞Í≥º"),
        React.createElement("div", {
          style: { display: "flex", flexWrap: "wrap", gap: "8px", justifyContent: "center", maxWidth: "420px", padding: "0 16px" }
        },
          ...displayed.map((r, i) =>
            React.createElement("div", { key: i, style: { animation: "popIn 0.3s ease-out" } },
              React.createElement(PetCard, { grade: r.grade, idx: r.idx, compact: true, hideEnhance: true })
            )
          )
        ),
        React.createElement("div", {
          style: { color: "#a0aec0", fontSize: "15px", fontFamily: "'Noto Sans KR', sans-serif" }
        }, revealedCount >= results.length
          ? (enhancedPets.length > 0 ? "ÌÉ≠ÌïòÏó¨ Í∞ïÌôî Í≤∞Í≥º Î≥¥Í∏∞" : "ÌÉ≠ÌïòÏó¨ Îã´Í∏∞")
          : "ÌÉ≠ÌïòÏó¨ Ïä§ÌÇµ")
      );
    };

    // Fusion/Craft result reveal
    const FusionReveal = ({ grade, idx, onClose, autoSummary }) => {
      const c = GRADE_COLORS[grade];
      const isAuto = !!autoSummary;
      return React.createElement("div", {
        onClick: onClose,
        style: {
          position: "fixed", inset: 0, zIndex: 1000,
          background: "rgba(0,0,0,0.9)", display: "flex", flexDirection: "column",
          alignItems: "center", justifyContent: "center", gap: "16px",
        }
      },
        React.createElement("div", {
          style: { color: isAuto ? "#f6e05e" : c.accent, fontSize: "15px", fontWeight: 600, fontFamily: "'Noto Sans KR', sans-serif" }
        }, grade === "SS" ? "‚ú® SS Ï†úÏûë ÏôÑÎ£å!" : isAuto ? "‚ö° ÏûêÎèôÌï©ÏÑ± ÏôÑÎ£å!" : "‚ú® Ìï©ÏÑ± ÏôÑÎ£å!"),
        // Auto summary stats
        isAuto && React.createElement("div", {
          style: {
            display: "flex", gap: "12px", justifyContent: "center",
            padding: "8px 16px", borderRadius: "10px",
            background: "rgba(246,224,94,0.08)", border: "1px solid rgba(246,224,94,0.15)",
          }
        },
          autoSummary.cToB > 0 && React.createElement("div", {
            style: { textAlign: "center" }
          },
            React.createElement("div", { style: { fontSize: "13px", color: "#a0aec0" } }, "C ‚Üí B"),
            React.createElement("div", { style: { fontSize: "16px", fontWeight: 900, color: GRADE_COLORS.B.accent } }, `√ó${autoSummary.cToB}`)
          ),
          autoSummary.bToA > 0 && React.createElement("div", {
            style: { textAlign: "center" }
          },
            React.createElement("div", { style: { fontSize: "13px", color: "#a0aec0" } }, "B ‚Üí A"),
            React.createElement("div", { style: { fontSize: "16px", fontWeight: 900, color: GRADE_COLORS.A.accent } }, `√ó${autoSummary.bToA}`)
          ),
          React.createElement("div", {
            style: { textAlign: "center" }
          },
            React.createElement("div", { style: { fontSize: "13px", color: "#a0aec0" } }, "Î®πÏù¥"),
            React.createElement("div", { style: { fontSize: "16px", fontWeight: 900, color: "#68d391" } }, `+${autoSummary.totalFeed} üçñ`)
          )
        ),
        // Auto fusion acquired pets
        // Auto fusion acquired pets
        isAuto && autoSummary.results && React.createElement("div", {
          style: { display: "flex", flexWrap: "wrap", gap: "6px", justifyContent: "center", maxWidth: "420px", padding: "0 12px" }
        },
          ...autoSummary.results.map((r, i) =>
            React.createElement("div", {
              key: i,
              style: { animation: "popIn 0.3s ease-out", animationDelay: `${i * 0.05}s`, animationFillMode: "both", position: "relative" }
            },
              React.createElement(PetCard, { grade: r.to, idx: r.idx, compact: true, hideEnhance: true }),
              r.leveledUp && React.createElement("div", {
                style: {
                  position: "absolute", bottom: "-2px", left: "50%", transform: "translateX(-50%)",
                  fontSize: "9px", fontWeight: 800, color: "#f6e05e",
                  background: "rgba(0,0,0,0.7)", padding: "1px 5px", borderRadius: "4px",
                  whiteSpace: "nowrap",
                }
              }, `‚¨Ü Lv.${r.newLevel}`)
            )
          )
        ),
        // Auto fusion level-up summary
        isAuto && autoSummary.results && (() => {
          const levelUps = autoSummary.results.filter((r) => r.leveledUp);
          if (levelUps.length === 0) return null;
          // Aggregate: group by pet, show highest level reached
          const grouped = {};
          levelUps.forEach((r) => {
            const key = `${r.to}_${r.idx}`;
            if (!grouped[key] || r.newLevel > grouped[key].newLevel) {
              grouped[key] = r;
            }
          });
          const entries = Object.values(grouped);
          return React.createElement("div", {
            style: {
              padding: "8px 14px", borderRadius: "10px",
              background: "rgba(246,224,94,0.08)", border: "1px solid rgba(246,224,94,0.15)",
              maxWidth: "380px", width: "100%",
            }
          },
            React.createElement("div", {
              style: { fontSize: "11px", color: "#f6e05e", fontWeight: 700, marginBottom: "6px", textAlign: "center" }
            }, `‚¨Ü Í∞ïÌôî ${levelUps.length}Ìöå Î∞úÏÉù`),
            React.createElement("div", {
              style: { display: "flex", flexWrap: "wrap", gap: "6px", justifyContent: "center" }
            },
              ...entries.map((r, i) => {
                const rc = GRADE_COLORS[r.to];
                const maxEnh = MAX_ENHANCE[r.to];
                const isMax = r.newLevel >= maxEnh;
                return React.createElement("div", {
                  key: i,
                  style: {
                    display: "flex", alignItems: "center", gap: "4px",
                    padding: "3px 8px", borderRadius: "6px",
                    background: isMax ? "rgba(72,187,120,0.15)" : "rgba(255,255,255,0.05)",
                    border: isMax ? "1px solid rgba(72,187,120,0.3)" : "1px solid rgba(255,255,255,0.08)",
                  }
                },
                  React.createElement("span", { style: { fontSize: "16px" } }, PET_EMOJIS[r.to][r.idx]),
                  React.createElement("span", { style: { fontSize: "11px", color: rc.text, fontWeight: 700 } }, PET_NAMES[r.to][r.idx]),
                  React.createElement("span", {
                    style: { fontSize: "10px", fontWeight: 800, color: isMax ? "#48bb78" : "#f6e05e" }
                  }, isMax ? " MAX" : ` +${r.newLevel}`)
                );
              })
            )
          );
        })(),
        !isAuto && React.createElement("div", {
          style: {
            fontSize: "72px", animation: "popIn 0.5s ease-out",
            filter: `drop-shadow(0 0 24px ${c.glow})`,
          }
        }, PET_EMOJIS[grade][idx]),
        !isAuto && React.createElement("div", {
          style: { display: "flex", alignItems: "center", gap: "8px", fontFamily: "'Noto Sans KR', sans-serif" }
        },
          React.createElement(GradeBadge, { grade, size: "md" }),
          React.createElement("span", {
            style: { color: c.text, fontSize: "20px", fontWeight: 800 }
          }, PET_NAMES[grade][idx])
        ),
        React.createElement("div", {
          style: { color: "#718096", fontSize: "15px", marginTop: "8px", fontFamily: "'Noto Sans KR', sans-serif" }
        }, "ÌÉ≠ÌïòÏó¨ Îã´Í∏∞")
      );
    };

    // ============================================================
    // MAIN APP
    // ============================================================
    function FusionApp() {
      const [inventory, setInventory] = useState(createInitialInventory);
      const [feed, setFeed] = useState(0);
      const [tab, setTab] = useState("pull");
      const [pullResult, setPullResult] = useState(null);
      const [fusionResult, setFusionResult] = useState(null);
      const [fusionSelect, setFusionSelect] = useState(null); // { grade, selected: [{grade,idx},...] }
      const [petDetail, setPetDetail] = useState(null); // { grade, idx, enhance }
      const [log, setLog] = useState([]);
      const [totalPulls, setTotalPulls] = useState(0);
      const logRef = useRef(null);

      const addLog = useCallback((msg) => {
        setLog((prev) => [...prev.slice(-50), { msg, time: Date.now() }]);
      }, []);

      useEffect(() => {
        if (logRef.current) logRef.current.scrollTop = logRef.current.scrollHeight;
      }, [log]);

      const addPet = useCallback((grade, idx, inv) => {
        const key = `${grade}_${idx}`;
        const pet = inv[key];
        const maxEnh = MAX_ENHANCE[grade];
        const copies = [...pet.copies];
        const nonMaxIdx = copies.findIndex((c) => c.enhance < maxEnh);
        let leveledUp = false;
        let newLevel = 0;

        if (maxEnh === 0) {
          copies.push({ enhance: 0 });
        } else if (copies.length === 0) {
          copies.push({ enhance: 0 });
        } else if (nonMaxIdx >= 0) {
          newLevel = copies[nonMaxIdx].enhance + 1;
          copies[nonMaxIdx] = { enhance: newLevel };
          leveledUp = true;
        } else {
          copies.push({ enhance: 0 });
        }
        return { inv: { ...inv, [key]: { ...pet, copies } }, leveledUp, newLevel };
      }, []);

      // PULL
      const doPull = useCallback((count) => {
        const results = [];
        let newInv = { ...inventory };
        for (const key of Object.keys(newInv)) {
          newInv[key] = { ...newInv[key], copies: [...newInv[key].copies] };
        }
        for (let i = 0; i < count; i++) {
          const r = pullOne();
          const { inv, leveledUp, newLevel } = addPet(r.grade, r.idx, newInv);
          newInv = inv;
          results.push({ ...r, leveledUp, newLevel });
        }
        setInventory(newInv);
        setTotalPulls((p) => p + count);
        setPullResult(results);

        const summary = {};
        results.forEach((r) => { summary[r.grade] = (summary[r.grade] || 0) + 1; });
        const summaryStr = Object.entries(summary).map(([g, c]) => `${g}√ó${c}`).join(" ");
        addLog(`üé∞ ${count}Ïó∞Ï∞® ÎΩëÍ∏∞: ${summaryStr}`);
      }, [inventory, addPet, addLog]);

      // FUSION - open selection modal
      const openFusionSelect = useCallback((grade) => {
        setFusionSelect({ grade, selected: [] });
      }, []);

      // Get available pets for fusion selection
      const getFusionCandidates = useCallback((grade) => {
        const maxEnh = MAX_ENHANCE[grade];
        const candidates = [];
        PET_NAMES[grade].forEach((_, i) => {
          const pet = inventory[`${grade}_${i}`];
          if (maxEnh === 0) {
            // C: all copies are candidates
            for (let ci = 0; ci < pet.copies.length; ci++) {
              candidates.push({ grade, idx: i, copyIdx: ci, enhance: pet.copies[ci].enhance, id: `${grade}_${i}_${ci}` });
            }
          } else {
            // B, A: only maxed copies
            pet.copies.forEach((c, ci) => {
              if (c.enhance >= maxEnh) {
                candidates.push({ grade, idx: i, copyIdx: ci, enhance: c.enhance, id: `${grade}_${i}_${ci}` });
              }
            });
          }
        });
        return candidates;
      }, [inventory]);

      // Execute fusion with selected pets
      const doFusion = useCallback((grade, selectedPets) => {
        const needed = FUSION_NEED[grade];
        if (selectedPets.length !== needed) return;
        const nextGrade = GRADES[GRADES.indexOf(grade) + 1];
        const resultIdx = Math.floor(Math.random() * PET_NAMES[nextGrade].length);

        let newInv = { ...inventory };
        for (const key of Object.keys(newInv)) {
          newInv[key] = { ...newInv[key], copies: [...newInv[key].copies] };
        }

        // Remove selected pets - group by pet key and sort copyIdx descending to avoid index shift
        const removeMap = {};
        selectedPets.forEach((sp) => {
          const key = `${sp.grade}_${sp.idx}`;
          if (!removeMap[key]) removeMap[key] = [];
          removeMap[key].push(sp.copyIdx);
        });

        for (const [key, indices] of Object.entries(removeMap)) {
          const pet = newInv[key];
          const sortedIndices = [...indices].sort((a, b) => b - a);
          for (const ci of sortedIndices) {
            pet.copies.splice(ci, 1);
          }
        }

        const { inv: fusedInv } = addPet(nextGrade, resultIdx, newInv);
        newInv = fusedInv;
        const feedGain = FEED_REWARD[grade];
        setFeed((f) => f + feedGain);
        setInventory(newInv);
        setFusionSelect(null);
        setFusionResult({ grade: nextGrade, idx: resultIdx });
        addLog(`üîÆ Ìï©ÏÑ±: ${grade} √ó${needed} ‚Üí ${nextGrade} ${PET_NAMES[nextGrade][resultIdx]} (+${feedGain} Î®πÏù¥)`);
      }, [inventory, addPet, addLog]);

      // AUTO FUSION (C‚ÜíB, B‚ÜíA chain)
      const doAutoFusion = useCallback(() => {
        let newInv = { ...inventory };
        for (const key of Object.keys(newInv)) {
          newInv[key] = { ...newInv[key], copies: [...newInv[key].copies] };
        }
        let totalFeed = 0;
        const results = [];

        // Loop: keep fusing C‚ÜíB then B‚ÜíA until nothing left to fuse
        let changed = true;
        while (changed) {
          changed = false;

          // C ‚Üí B (no enhance needed, just need 4 C copies)
          while (true) {
            let cTotal = 0;
            PET_NAMES.C.forEach((_, i) => { cTotal += newInv[`C_${i}`].copies.length; });
            if (cTotal < FUSION_NEED.C) break;

            // Remove C copies
            let toRemove = FUSION_NEED.C;
            for (let i = 0; i < PET_NAMES.C.length && toRemove > 0; i++) {
              const key = `C_${i}`;
              const pet = newInv[key];
              const removeCount = Math.min(pet.copies.length, toRemove);
              pet.copies = pet.copies.slice(removeCount);
              toRemove -= removeCount;
            }

            // Add random B
            const resultIdx = Math.floor(Math.random() * PET_NAMES.B.length);
            const { inv: fusedInv, leveledUp, newLevel } = addPet("B", resultIdx, newInv);
            newInv = fusedInv;
            totalFeed += FEED_REWARD.C;
            results.push({ from: "C", to: "B", idx: resultIdx, leveledUp, newLevel });
            changed = true;
          }

          // B ‚Üí A (need maxed B, 3 copies)
          while (true) {
            let bMaxed = 0;
            PET_NAMES.B.forEach((_, i) => {
              bMaxed += newInv[`B_${i}`].copies.filter((c) => c.enhance >= MAX_ENHANCE.B).length;
            });
            if (bMaxed < FUSION_NEED.B) break;

            // Remove maxed B copies
            let toRemove = FUSION_NEED.B;
            for (let i = 0; i < PET_NAMES.B.length && toRemove > 0; i++) {
              const key = `B_${i}`;
              const pet = newInv[key];
              const newCopies = [];
              for (const c of pet.copies) {
                if (c.enhance >= MAX_ENHANCE.B && toRemove > 0) {
                  toRemove--;
                } else {
                  newCopies.push(c);
                }
              }
              pet.copies = newCopies;
            }

            // Add random A
            const resultIdx = Math.floor(Math.random() * PET_NAMES.A.length);
            const { inv: fusedInv, leveledUp, newLevel } = addPet("A", resultIdx, newInv);
            newInv = fusedInv;
            totalFeed += FEED_REWARD.B;
            results.push({ from: "B", to: "A", idx: resultIdx, leveledUp, newLevel });
            changed = true;
          }
        }

        if (results.length === 0) return;

        setFeed((f) => f + totalFeed);
        setInventory(newInv);

        // Show summary as fusion result
        const cToB = results.filter((r) => r.from === "C").length;
        const bToA = results.filter((r) => r.from === "B").length;
        let logMsg = `‚ö° ÏûêÎèôÌï©ÏÑ±: `;
        if (cToB > 0) logMsg += `C‚ÜíB √ó${cToB} `;
        if (bToA > 0) logMsg += `B‚ÜíA √ó${bToA} `;
        logMsg += `(+${totalFeed} Î®πÏù¥)`;
        addLog(logMsg);

        setFusionResult({ grade: "B", idx: 0, autoSummary: { cToB, bToA, totalFeed, results } });
      }, [inventory, addPet, addLog]);

      // Check if auto fusion is possible
      const canAutoFuse = useMemo(() => {
        let cTotal = 0;
        PET_NAMES.C.forEach((_, i) => { cTotal += inventory[`C_${i}`].copies.length; });
        let bMaxed = 0;
        PET_NAMES.B.forEach((_, i) => {
          bMaxed += inventory[`B_${i}`].copies.filter((c) => c.enhance >= MAX_ENHANCE.B).length;
        });
        return cTotal >= FUSION_NEED.C || bMaxed >= FUSION_NEED.B;
      }, [inventory]);

      // SS CRAFT
      const getAvailableCrafts = useCallback(() => {
        return SS_RECIPES.map((recipe) => {
          const pet1 = inventory[`S_${recipe.mat1}`];
          const pet2 = inventory[`S_${recipe.mat2}`];
          const maxed1 = pet1.copies.filter((c) => c.enhance >= MAX_ENHANCE.S).length;
          const maxed2 = pet2.copies.filter((c) => c.enhance >= MAX_ENHANCE.S).length;
          return { ...recipe, maxed1, maxed2, canCraft: maxed1 >= 1 && maxed2 >= 1 };
        });
      }, [inventory]);

      const doCraft = useCallback((recipe) => {
        let newInv = { ...inventory };
        for (const key of Object.keys(newInv)) {
          newInv[key] = { ...newInv[key], copies: [...newInv[key].copies] };
        }
        for (const matIdx of [recipe.mat1, recipe.mat2]) {
          const key = `S_${matIdx}`;
          const pet = newInv[key];
          const maxedIdx = pet.copies.findIndex((c) => c.enhance >= MAX_ENHANCE.S);
          if (maxedIdx >= 0) pet.copies.splice(maxedIdx, 1);
        }
        const ssKey = `SS_${recipe.result}`;
        newInv[ssKey] = { ...newInv[ssKey], copies: [...newInv[ssKey].copies, { enhance: 0 }] };
        setInventory(newInv);
        setFusionResult({ grade: "SS", idx: recipe.result });
        addLog(`üëë SS Ï†úÏûë: ${PET_NAMES.S[recipe.mat1]} + ${PET_NAMES.S[recipe.mat2]} ‚Üí ${PET_NAMES.SS[recipe.result]}`);
      }, [inventory, addLog]);

      // EXCHANGE
      const doExchange = useCallback((sIdx) => {
        if (feed < S_EXCHANGE_COST) return;
        setFeed((f) => f - S_EXCHANGE_COST);
        let newInv = { ...inventory };
        for (const key of Object.keys(newInv)) {
          newInv[key] = { ...newInv[key], copies: [...newInv[key].copies] };
        }
        const { inv: exchangedInv } = addPet("S", sIdx, newInv);
        newInv = exchangedInv;
        setInventory(newInv);
        setFusionResult({ grade: "S", idx: sIdx });
        addLog(`üçñ Î®πÏù¥ ÍµêÌôò: ${PET_NAMES.S[sIdx]} ÌöçÎìù (-${S_EXCHANGE_COST} Î®πÏù¥)`);
      }, [feed, inventory, addPet, addLog]);

      // Stats
      const stats = useMemo(() => {
        const counts = {};
        GRADES.forEach((g) => {
          let total = 0;
          PET_NAMES[g].forEach((_, i) => { total += inventory[`${g}_${i}`].copies.length; });
          counts[g] = total;
        });
        return counts;
      }, [inventory]);

      const tabsData = [
        { id: "pull", label: "üé∞ ÎΩëÍ∏∞", color: "#f6ad55" },
        { id: "inventory", label: "üì¶ Ïù∏Î≤§ÌÜ†Î¶¨", color: "#63b3ed" },
        { id: "fusion", label: "üîÆ Ìï©ÏÑ±", color: "#b794f4" },
        { id: "craft", label: "üëë SSÏ†úÏûë", color: "#fc8181" },
        { id: "exchange", label: "üçñ ÍµêÌôòÏÜå", color: "#68d391" },
      ];

      // ---- RENDER HELPERS ----

      const renderPullTab = () => {
        return React.createElement("div", {
          style: { display: "flex", flexDirection: "column", gap: "16px", alignItems: "center" }
        },
          React.createElement("div", {
            style: {
              width: "100%", maxWidth: "360px", padding: "24px", borderRadius: "16px",
              background: "linear-gradient(145deg, rgba(246,173,85,0.08), rgba(246,173,85,0.02))",
              border: "1px solid rgba(246,173,85,0.15)", textAlign: "center",
            }
          },
            React.createElement("div", { style: { fontSize: "56px", marginBottom: "16px" } }, "üé∞"),
            React.createElement("div", {
              style: { fontSize: "15px", color: "#a0aec0", marginBottom: "20px" }
            }, "C(55%) ¬∑ B(30%) ¬∑ A(12%) ¬∑ S(3%)"),
            React.createElement("div", {
              style: { display: "flex", gap: "10px", justifyContent: "center" }
            },
              React.createElement("button", {
                onClick: () => doPull(1),
                style: {
                  padding: "12px 28px", borderRadius: "10px", border: "none",
                  background: "linear-gradient(135deg, #c05621, #dd6b20)",
                  color: "#fff", fontSize: "15px", fontWeight: 800, cursor: "pointer",
                  fontFamily: "'Noto Sans KR', sans-serif",
                  boxShadow: "0 4px 15px rgba(192,86,33,0.3)",
                }
              }, "1Ìöå ÎΩëÍ∏∞"),
              React.createElement("button", {
                onClick: () => doPull(10),
                style: {
                  padding: "12px 28px", borderRadius: "10px", border: "none",
                  background: "linear-gradient(135deg, #e53e3e, #fc8181)",
                  color: "#fff", fontSize: "15px", fontWeight: 800, cursor: "pointer",
                  fontFamily: "'Noto Sans KR', sans-serif",
                  boxShadow: "0 4px 15px rgba(229,62,62,0.3)",
                }
              }, "üî• 10Ïó∞Ï∞®")
            )
          ),
          // Rates
          React.createElement("div", {
            style: {
              width: "100%", maxWidth: "360px", padding: "12px",
              borderRadius: "10px", background: "rgba(255,255,255,0.03)",
              border: "1px solid rgba(255,255,255,0.05)",
            }
          },
            React.createElement("div", {
              style: { fontSize: "15px", fontWeight: 700, color: "#718096", marginBottom: "8px" }
            }, "ÌôïÎ•† Ï†ïÎ≥¥"),
            ...Object.entries(PULL_RATES).map(([g, r]) =>
              React.createElement("div", {
                key: g,
                style: { display: "flex", alignItems: "center", gap: "6px", marginBottom: "4px" }
              },
                React.createElement(GradeBadge, { grade: g, size: "xs" }),
                React.createElement("div", {
                  style: { flex: 1, height: "6px", borderRadius: "3px", background: "rgba(255,255,255,0.05)" }
                },
                  React.createElement("div", {
                    style: {
                      width: `${r * 100}%`, height: "100%", borderRadius: "3px",
                      background: GRADE_COLORS[g].accent,
                    }
                  })
                ),
                React.createElement("span", {
                  style: { fontSize: "12px", color: "#a0aec0", width: "36px", textAlign: "right" }
                }, `${(r * 100).toFixed(0)}%`)
              )
            )
          )
        );
      };

      const renderInventoryTab = () => {
        const sections = [...GRADES].reverse().map((g) => {
          const pets = [];
          PET_NAMES[g].forEach((_, i) => {
            const pet = inventory[`${g}_${i}`];
            if (pet.copies.length > 0) {
              const maxEnh = MAX_ENHANCE[g];
              if (maxEnh === 0) {
                pets.push({ grade: g, idx: i, enhance: 0, count: pet.copies.length });
              } else {
                const maxedCount = pet.copies.filter((c) => c.enhance >= maxEnh).length;
                const nonMaxCopies = pet.copies.filter((c) => c.enhance < maxEnh);
                if (maxedCount > 0) {
                  pets.push({ grade: g, idx: i, enhance: maxEnh, count: maxedCount, isMaxed: true });
                }
                if (nonMaxCopies.length > 0) {
                  pets.push({ grade: g, idx: i, enhance: nonMaxCopies[0].enhance, count: nonMaxCopies.length, isMaxed: false });
                }
              }
            }
          });
          if (pets.length === 0) return null;
          return React.createElement("div", { key: g },
            React.createElement("div", {
              style: {
                display: "flex", alignItems: "center", gap: "6px",
                marginBottom: "8px", paddingBottom: "4px",
                borderBottom: `1px solid ${GRADE_COLORS[g].bg}33`,
              }
            },
              React.createElement(GradeBadge, { grade: g, size: "sm" }),
              React.createElement("span", {
                style: { fontSize: "15px", fontWeight: 700, color: GRADE_COLORS[g].text }
              }, `${g}Îì±Í∏â (${pets.reduce((a, p) => a + p.count, 0)}ÎßàÎ¶¨)`)
            ),
            React.createElement("div", {
              style: { display: "flex", flexWrap: "wrap", gap: "6px" }
            },
              ...pets.map((p, i) =>
                React.createElement(PetCard, {
                  key: `${p.idx}-${p.isMaxed}-${i}`,
                  grade: p.grade, idx: p.idx,
                  enhanceLevel: p.enhance, count: p.count, compact: true,
                  onClick: () => setPetDetail({ grade: p.grade, idx: p.idx, enhance: p.enhance }),
                })
              )
            )
          );
        }).filter(Boolean);

        if (sections.length === 0) {
          return React.createElement("div", {
            style: { textAlign: "center", color: "#4a5568", padding: "40px 0", fontSize: "15px" }
          }, "Î≥¥Ïú†Ìïú Ìé´Ïù¥ ÏóÜÏäµÎãàÎã§. ÎΩëÍ∏∞Î•º ÏãúÏûëÌï¥Î≥¥ÏÑ∏Ïöî!");
        }

        return React.createElement("div", {
          style: { display: "flex", flexDirection: "column", gap: "16px" }
        }, ...sections);
      };

      const renderFusionTab = () => {
        return React.createElement("div", {
          style: { display: "flex", flexDirection: "column", gap: "16px" }
        },
          ...["C", "B", "A"].map((g) => {
            const nextG = GRADES[GRADES.indexOf(g) + 1];
            const maxEnh = MAX_ENHANCE[g];
            const needed = FUSION_NEED[g];
            const c = GRADE_COLORS[g];
            const nc = GRADE_COLORS[nextG];

            let available = 0;
            if (maxEnh === 0) {
              PET_NAMES[g].forEach((_, i) => { available += inventory[`${g}_${i}`].copies.length; });
            } else {
              PET_NAMES[g].forEach((_, i) => {
                available += inventory[`${g}_${i}`].copies.filter((cp) => cp.enhance >= maxEnh).length;
              });
            }
            const canFuse = available >= needed;

            return React.createElement("div", {
              key: g,
              style: {
                padding: "14px", borderRadius: "12px",
                background: `linear-gradient(145deg, ${c.bg}15, ${nc.bg}10)`,
                border: `1px solid ${c.bg}33`,
              }
            },
              React.createElement("div", {
                style: { display: "flex", alignItems: "center", justifyContent: "space-between", marginBottom: "10px" }
              },
                React.createElement("div", {
                  style: { display: "flex", alignItems: "center", gap: "6px" }
                },
                  React.createElement(GradeBadge, { grade: g, size: "sm" }),
                  React.createElement("span", { style: { fontSize: "15px", color: "#a0aec0" } }, "‚Üí"),
                  React.createElement(GradeBadge, { grade: nextG, size: "sm" })
                ),
                React.createElement("span", {
                  style: { fontSize: "15px", color: "#718096" }
                }, `${maxEnh > 0 ? "ÎßåÎ†ô " : ""}${g} √ó${needed} ‚Üí ÎûúÎç§ ${nextG}`)
              ),
              React.createElement("div", {
                style: { display: "flex", alignItems: "center", gap: "8px" }
              },
                React.createElement("div", { style: { flex: 1 } },
                  React.createElement("div", {
                    style: { display: "flex", justifyContent: "space-between", marginBottom: "4px" }
                  },
                    React.createElement("span", {
                      style: { fontSize: "15px", color: "#a0aec0" }
                    }, `${maxEnh > 0 ? "ÎßåÎ†ô " : ""}${g} Î≥¥Ïú†`),
                    React.createElement("span", {
                      style: { fontSize: "15px", fontWeight: 700, color: canFuse ? "#48bb78" : "#a0aec0" }
                    }, `${available} / ${needed}`)
                  ),
                  React.createElement("div", {
                    style: { height: "6px", borderRadius: "3px", background: "rgba(255,255,255,0.05)" }
                  },
                    React.createElement("div", {
                      style: {
                        width: `${Math.min(100, (available / needed) * 100)}%`,
                        height: "100%", borderRadius: "3px",
                        background: canFuse ? "#48bb78" : c.accent,
                        transition: "width 0.3s",
                      }
                    })
                  )
                ),
                React.createElement("button", {
                  onClick: () => canFuse && openFusionSelect(g),
                  disabled: !canFuse,
                  style: {
                    padding: "8px 16px", borderRadius: "8px", border: "none",
                    background: canFuse ? `linear-gradient(135deg, ${nc.bg}, ${nc.accent})` : "rgba(255,255,255,0.05)",
                    color: canFuse ? "#fff" : "#4a5568",
                    fontSize: "15px", fontWeight: 800, cursor: canFuse ? "pointer" : "default",
                    fontFamily: "'Noto Sans KR', sans-serif",
                    boxShadow: canFuse ? `0 4px 12px ${nc.glow}` : "none",
                    opacity: canFuse ? 1 : 0.5, flexShrink: 0,
                  }
                }, `Ìï©ÏÑ± (+${FEED_REWARD[g]}üçñ)`)
              )
            );
          }),
          // Auto fusion button
          React.createElement("button", {
            onClick: () => canAutoFuse && doAutoFusion(),
            disabled: !canAutoFuse,
            style: {
              width: "100%", padding: "12px", borderRadius: "10px", border: "none",
              background: canAutoFuse
                ? "linear-gradient(135deg, #d69e2e, #f6e05e)"
                : "rgba(255,255,255,0.05)",
              color: canAutoFuse ? "#744210" : "#4a5568",
              fontSize: "15px", fontWeight: 900, cursor: canAutoFuse ? "pointer" : "default",
              fontFamily: "'Noto Sans KR', sans-serif",
              boxShadow: canAutoFuse ? "0 4px 15px rgba(214,158,46,0.3)" : "none",
              opacity: canAutoFuse ? 1 : 0.5,
              letterSpacing: "0.5px",
            }
          }, "‚ö° ÏûêÎèôÌï©ÏÑ± (C‚ÜíB‚ÜíA ÏùºÍ¥Ñ)"),

          React.createElement("div", {
            style: {
              padding: "10px", borderRadius: "8px",
              background: "rgba(255,255,255,0.02)",
              border: "1px solid rgba(255,255,255,0.05)",
            }
          },
            React.createElement("div", {
              style: { fontSize: "15px", color: "#718096", lineHeight: 1.6 }
            },
              "üí° ", React.createElement("strong", null, "Ìï©ÏÑ± Í∑úÏπô"), React.createElement("br"),
              "¬∑ CÎäî ÏïÑÎ¨¥ C 4ÎßàÎ¶¨Î°ú Ìï©ÏÑ± Í∞ÄÎä•", React.createElement("br"),
              "¬∑ BÎäî ÎßåÎ†ô(+1) B 3ÎßàÎ¶¨ ÌïÑÏöî", React.createElement("br"),
              "¬∑ AÎäî ÎßåÎ†ô(+1) A 2ÎßàÎ¶¨ ÌïÑÏöî", React.createElement("br"),
              "¬∑ Ìï©ÏÑ±Ìï† ÎïåÎßàÎã§ Ìé´ Î®πÏù¥ ÌöçÎìù!"
            )
          )
        );
      };

      const renderCraftTab = () => {
        const crafts = getAvailableCrafts();
        return React.createElement("div", {
          style: { display: "flex", flexDirection: "column", gap: "12px" }
        },
          React.createElement("div", {
            style: { fontSize: "15px", color: "#718096", marginBottom: "4px" }
          }, "ÎßåÎ†ô(+2) S Ìé´ 2ÎßàÎ¶¨Î°ú SSÎ•º Ï†úÏûëÌï©ÎãàÎã§"),
          ...crafts.map((recipe, i) => {
            const ssC = GRADE_COLORS.SS;
            return React.createElement("div", {
              key: i,
              style: {
                padding: "14px", borderRadius: "12px",
                background: recipe.canCraft
                  ? "linear-gradient(145deg, rgba(229,62,62,0.1), rgba(229,62,62,0.03))"
                  : "rgba(255,255,255,0.02)",
                border: recipe.canCraft
                  ? "1px solid rgba(229,62,62,0.3)"
                  : "1px solid rgba(255,255,255,0.05)",
              }
            },
              // Result header - clickable SS pet
              React.createElement("div", {
                style: { display: "flex", alignItems: "center", gap: "10px", marginBottom: "10px" }
              },
                React.createElement("div", {
                  onClick: () => setPetDetail({ grade: "SS", idx: recipe.result, enhance: 0 }),
                  style: { cursor: "pointer", transition: "transform 0.2s" },
                  onMouseEnter: (e) => e.currentTarget.style.transform = "scale(1.1)",
                  onMouseLeave: (e) => e.currentTarget.style.transform = "scale(1)",
                },
                  React.createElement(PetCard, {
                    grade: "SS", idx: recipe.result, compact: true, hideEnhance: true,
                  })
                ),
                React.createElement("div", {
                  style: { display: "flex", flexDirection: "column", gap: "2px" }
                },
                  React.createElement("div", {
                    style: { display: "flex", alignItems: "center", gap: "4px" }
                  },
                    React.createElement(GradeBadge, { grade: "SS", size: "sm" }),
                    React.createElement("span", {
                      style: { fontSize: "15px", fontWeight: 800, color: ssC.text }
                    }, PET_NAMES.SS[recipe.result])
                  ),
                  React.createElement("div", {
                    style: { fontSize: "11px", color: "#718096", cursor: "pointer" },
                    onClick: () => setPetDetail({ grade: "SS", idx: recipe.result, enhance: 0 }),
                  }, "üëÜ ÌÑ∞ÏπòÌïòÏó¨ Ïä§ÌÇ¨ ÌôïÏù∏")
                )
              ),
              // Materials
              React.createElement("div", {
                style: { display: "flex", gap: "8px", marginBottom: "10px" }
              },
                ...[recipe.mat1, recipe.mat2].map((matIdx, mi) => {
                  const pet = inventory[`S_${matIdx}`];
                  const maxed = pet.copies.filter((c) => c.enhance >= MAX_ENHANCE.S).length;
                  const total = pet.copies.length;
                  const has = maxed >= 1;
                  return React.createElement("div", {
                    key: mi,
                    style: {
                      flex: 1, padding: "8px", borderRadius: "8px",
                      background: has ? "rgba(72,187,120,0.1)" : "rgba(255,255,255,0.03)",
                      border: `1px solid ${has ? "rgba(72,187,120,0.3)" : "rgba(255,255,255,0.05)"}`,
                      textAlign: "center",
                    }
                  },
                    React.createElement("div", { style: { fontSize: "24px" } }, PET_EMOJIS.S[matIdx]),
                    React.createElement("div", {
                      style: { fontSize: "15px", color: "#a0aec0", marginTop: "2px" }
                    }, PET_NAMES.S[matIdx]),
                    React.createElement("div", {
                      style: { fontSize: "15px", fontWeight: 700, marginTop: "2px", color: has ? "#48bb78" : "#e53e3e" }
                    }, `ÎßåÎ†ô: ${maxed}/1 ${has ? "‚úì" : "‚úó"}`),
                    total > 0 && !has && React.createElement("div", {
                      style: { fontSize: "15px", color: "#718096", marginTop: "1px" }
                    }, `(Î≥¥Ïú† ${total}, Í∞ïÌôîÏ§ë)`)
                  );
                })
              ),
              // Craft button
              React.createElement("button", {
                onClick: () => recipe.canCraft && doCraft(recipe),
                disabled: !recipe.canCraft,
                style: {
                  width: "100%", padding: "10px", borderRadius: "8px", border: "none",
                  background: recipe.canCraft
                    ? "linear-gradient(135deg, #e53e3e, #fc8181)"
                    : "rgba(255,255,255,0.05)",
                  color: recipe.canCraft ? "#fff" : "#4a5568",
                  fontSize: "15px", fontWeight: 800, cursor: recipe.canCraft ? "pointer" : "default",
                  fontFamily: "'Noto Sans KR', sans-serif",
                  boxShadow: recipe.canCraft ? "0 4px 15px rgba(229,62,62,0.3)" : "none",
                  opacity: recipe.canCraft ? 1 : 0.5,
                }
              }, recipe.canCraft ? "üëë SS Ï†úÏûë!" : "Ïû¨Î£å Î∂ÄÏ°±")
            );
          })
        );
      };

      const renderExchangeTab = () => {
        return React.createElement("div", {
          style: { display: "flex", flexDirection: "column", gap: "12px" }
        },
          React.createElement("div", {
            style: {
              padding: "12px", borderRadius: "10px",
              background: "linear-gradient(145deg, rgba(104,211,145,0.08), rgba(104,211,145,0.02))",
              border: "1px solid rgba(104,211,145,0.15)",
              display: "flex", alignItems: "center", justifyContent: "space-between",
            }
          },
            React.createElement("span", { style: { fontSize: "15px", color: "#a0aec0" } }, "Î≥¥Ïú† Î®πÏù¥"),
            React.createElement("span", {
              style: { fontSize: "20px", fontWeight: 900, color: "#68d391" }
            }, `üçñ ${feed}`)
          ),
          React.createElement("div", {
            style: { fontSize: "15px", color: "#718096" }
          }, `ÏõêÌïòÎäî S Ìé´ÏùÑ ${S_EXCHANGE_COST} Î®πÏù¥Î°ú ÌôïÏ†ï ÍµêÌôò`),
          React.createElement("div", {
            style: { display: "flex", flexWrap: "wrap", gap: "8px" }
          },
            ...PET_NAMES.S.map((name, i) => {
              const canBuy = feed >= S_EXCHANGE_COST;
              const pet = inventory[`S_${i}`];
              const owned = pet.copies.length;
              return React.createElement("div", {
                key: i,
                onClick: () => canBuy && doExchange(i),
                style: {
                  width: "calc(33.33% - 6px)", padding: "10px 6px",
                  borderRadius: "10px", textAlign: "center",
                  background: canBuy ? "rgba(192,86,33,0.08)" : "rgba(255,255,255,0.02)",
                  border: `1px solid ${canBuy ? "rgba(192,86,33,0.2)" : "rgba(255,255,255,0.05)"}`,
                  cursor: canBuy ? "pointer" : "default",
                  opacity: canBuy ? 1 : 0.5, transition: "all 0.2s",
                }
              },
                React.createElement("div", { style: { fontSize: "28px" } }, PET_EMOJIS.S[i]),
                React.createElement("div", {
                  style: { fontSize: "15px", color: GRADE_COLORS.S.text, marginTop: "2px", fontWeight: 600 }
                }, name),
                React.createElement("div", {
                  style: { fontSize: "15px", color: "#718096", marginTop: "2px" }
                }, `Î≥¥Ïú†: ${owned}`),
                React.createElement("div", {
                  style: { marginTop: "4px", fontSize: "15px", fontWeight: 700, color: canBuy ? "#68d391" : "#4a5568" }
                }, `üçñ ${S_EXCHANGE_COST}`)
              );
            })
          )
        );
      };

      // ---- MAIN RENDER ----
      return React.createElement("div", {
        style: {
          height: "100%", width: "100%",
          fontFamily: "'Noto Sans KR', -apple-system, sans-serif",
          color: "#e2e8f0",
          display: "flex", flexDirection: "column",
          position: "relative",
        }
      },
        // Header
        React.createElement("div", {
          style: {
            padding: "12px 16px",
            background: "linear-gradient(90deg, rgba(99,179,237,0.08), rgba(183,148,244,0.08), rgba(252,129,129,0.08))",
            borderBottom: "1px solid rgba(255,255,255,0.05)",
            display: "flex", alignItems: "center", justifyContent: "space-between",
          }
        },
          React.createElement("div", null,
            React.createElement("div", {
              style: { fontSize: "18px", fontWeight: 900, letterSpacing: "-0.5px" }
            }, "üêæ Ìé´ ÏãúÏä§ÌÖú ÌîÑÎ°úÌÜ†ÌÉÄÏûÖ"),
            React.createElement("div", {
              style: { fontSize: "15px", color: "#718096", marginTop: "2px" }
            }, `Ï¥ù ÎΩëÍ∏∞: ${totalPulls}Ìöå | Î≥¥Ïú†: ${Object.values(stats).reduce((a, b) => a + b, 0)}ÎßàÎ¶¨`)
          ),
          React.createElement("div", {
            style: {
              display: "flex", gap: "6px", alignItems: "center",
              background: "rgba(104,211,145,0.1)", padding: "4px 10px", borderRadius: "8px",
              border: "1px solid rgba(104,211,145,0.2)",
            }
          },
            React.createElement("span", { style: { fontSize: "15px" } }, "üçñ"),
            React.createElement("span", {
              style: { fontSize: "15px", fontWeight: 800, color: "#68d391" }
            }, feed)
          )
        ),

        // Grade summary
        React.createElement("div", {
          style: { display: "flex", padding: "6px 16px", gap: "4px", background: "rgba(0,0,0,0.2)" }
        },
          ...GRADES.map((g) =>
            React.createElement("div", {
              key: g,
              style: {
                flex: 1, textAlign: "center", padding: "3px",
                borderRadius: "6px", background: `${GRADE_COLORS[g].bg}22`,
              }
            },
              React.createElement(GradeBadge, { grade: g, size: "xs" }),
              React.createElement("span", {
                style: { fontSize: "12px", color: GRADE_COLORS[g].text, marginLeft: "4px", fontWeight: 700 }
              }, stats[g])
            )
          )
        ),

        // Tab bar
        React.createElement("div", {
          style: {
            display: "flex", padding: "8px 12px", gap: "4px",
            borderBottom: "1px solid rgba(255,255,255,0.05)",
            overflowX: "auto",
          }
        },
          ...tabsData.map((t) =>
            React.createElement("button", {
              key: t.id,
              onClick: () => setTab(t.id),
              style: {
                flex: "0 0 auto",
                padding: "6px 12px", borderRadius: "8px", border: "none",
                background: tab === t.id ? `${t.color}22` : "transparent",
                color: tab === t.id ? t.color : "#718096",
                fontSize: "13px", fontWeight: 700, cursor: "pointer",
                fontFamily: "'Noto Sans KR', sans-serif",
                transition: "all 0.2s",
                borderBottom: tab === t.id ? `2px solid ${t.color}` : "2px solid transparent",
              }
            }, t.label)
          )
        ),

        // Content
        React.createElement("div", {
          style: { flex: 1, padding: "12px 16px", overflowY: "auto" }
        },
          tab === "pull" && renderPullTab(),
          tab === "inventory" && renderInventoryTab(),
          tab === "fusion" && renderFusionTab(),
          tab === "craft" && renderCraftTab(),
          tab === "exchange" && renderExchangeTab()
        ),

        // Activity log
        React.createElement("div", {
          style: { borderTop: "1px solid rgba(255,255,255,0.05)", background: "rgba(0,0,0,0.3)" }
        },
          React.createElement("div", {
            style: {
              padding: "6px 16px 4px", fontSize: "11px", fontWeight: 700,
              color: "#4a5568", display: "flex", justifyContent: "space-between",
            }
          },
            React.createElement("span", null, "ÌôúÎèô Î°úÍ∑∏"),
            log.length > 0 && React.createElement("span", {
              onClick: () => setLog([]),
              style: { cursor: "pointer", color: "#718096" }
            }, "ÏßÄÏö∞Í∏∞")
          ),
          React.createElement("div", {
            ref: logRef,
            style: { height: "64px", overflowY: "auto", padding: "0 16px 8px" }
          },
            log.length === 0
              ? React.createElement("div", {
                  style: { fontSize: "11px", color: "#2d3748", paddingTop: "4px" }
                }, "ÎΩëÍ∏∞Î•º ÏãúÏûëÌï¥Î≥¥ÏÑ∏Ïöî!")
              : log.map((l, i) =>
                  React.createElement("div", {
                    key: i,
                    style: { fontSize: "11px", color: "#718096", lineHeight: 1.8 }
                  }, l.msg)
                )
          )
        ),

        // Overlays
        pullResult && React.createElement(PullReveal, { results: pullResult, onClose: () => setPullResult(null) }),
        fusionResult && React.createElement(FusionReveal, { grade: fusionResult.grade, idx: fusionResult.idx, autoSummary: fusionResult.autoSummary, onClose: () => setFusionResult(null) }),

        // Pet Detail Popup
        petDetail && (() => {
          const { grade, idx, enhance } = petDetail;
          const c = GRADE_COLORS[grade];
          const skill = PET_SKILLS[grade][idx];
          const maxEnh = MAX_ENHANCE[grade];
          const passiveCount = PASSIVE_COUNT[grade];
          const isSSGrade = grade === "SS";

          return React.createElement("div", {
            onClick: (e) => { if (e.target === e.currentTarget) setPetDetail(null); },
            style: {
              position: "fixed", inset: 0, zIndex: 1000,
              background: "rgba(0,0,0,0.88)", display: "flex",
              alignItems: "center", justifyContent: "center",
              padding: "16px",
            }
          },
            React.createElement("div", {
              style: {
                width: "100%", maxWidth: "360px", maxHeight: "80vh", overflowY: "auto",
                borderRadius: "16px",
                background: `linear-gradient(160deg, #1a202c, ${c.bg}15, #1a202c)`,
                border: `1px solid ${c.bg}55`,
                boxShadow: `0 0 40px ${c.glow}`,
                padding: "20px",
              }
            },
              // Header: emoji + name + grade
              React.createElement("div", {
                style: { textAlign: "center", marginBottom: "16px" }
              },
                React.createElement("div", {
                  style: { fontSize: "56px", lineHeight: 1, marginBottom: "8px",
                    filter: `drop-shadow(0 0 16px ${c.glow})`,
                  }
                }, PET_EMOJIS[grade][idx]),
                React.createElement("div", {
                  style: { display: "flex", alignItems: "center", gap: "6px", justifyContent: "center", marginBottom: "4px" }
                },
                  React.createElement(GradeBadge, { grade, size: "md" }),
                  React.createElement("span", {
                    style: { fontSize: "18px", fontWeight: 900, color: c.text }
                  }, PET_NAMES[grade][idx])
                ),
                // Enhance level
                maxEnh > 0 && React.createElement("div", {
                  style: { fontSize: "15px", color: enhance >= maxEnh ? "#48bb78" : "#a0aec0", fontWeight: 700, marginTop: "2px" }
                }, enhance >= maxEnh ? "‚ú® MAX Í∞ïÌôî" : `Í∞ïÌôî +${enhance} / ${maxEnh}`),
                // SS: no enhance
                isSSGrade && React.createElement("div", {
                  style: { fontSize: "15px", color: "#fc8181", fontWeight: 700, marginTop: "2px" }
                }, "üëë ÏµúÍ≥† Îì±Í∏â")
              ),

              // Divider
              React.createElement("div", { style: { height: "1px", background: `${c.bg}44`, marginBottom: "14px" } }),

              // Active Skill
              (() => {
                const coolReduce = COOL_REDUCE[grade] || 0;
                const totalCoolReduce = coolReduce * enhance;
                const currentCool = skill.active.cooldown - totalCoolReduce;
                const baseCool = skill.active.cooldown;
                const isCoolReduced = totalCoolReduce > 0;

                return React.createElement("div", { style: { marginBottom: "14px" } },
                  React.createElement("div", {
                    style: { display: "flex", alignItems: "center", gap: "6px", marginBottom: "8px" }
                  },
                    React.createElement("span", {
                      style: {
                        fontSize: "12px", fontWeight: 800, color: "#fff",
                        background: c.accent, padding: "2px 8px", borderRadius: "4px",
                      }
                    }, "Ïï°Ìã∞Î∏å"),
                    React.createElement("span", {
                      style: { fontSize: "13px", color: isCoolReduced ? "#f6e05e" : "#718096", fontWeight: isCoolReduced ? 700 : 400 }
                    }, isCoolReduced ? `Ïø®ÌÉÄÏûÑ ${currentCool}ÌÑ¥ (${baseCool}‚Üí${currentCool})` : `Ïø®ÌÉÄÏûÑ ${baseCool}ÌÑ¥`)
                  ),
                  React.createElement("div", {
                    style: {
                      padding: "10px 12px", borderRadius: "10px",
                      background: `${c.bg}22`, border: `1px solid ${c.bg}33`,
                    }
                  },
                    React.createElement("div", {
                      style: { fontSize: "14px", fontWeight: 800, color: c.text, marginBottom: "4px" }
                    }, skill.active.name),
                    React.createElement("div", {
                      style: { fontSize: "13px", color: "#a0aec0", lineHeight: 1.5 }
                    }, skill.active.desc),
                    // Cooldown upgrade preview
                    maxEnh > 0 && !isSSGrade && enhance < maxEnh && React.createElement("div", {
                      style: { fontSize: "11px", color: "#718096", marginTop: "6px", fontStyle: "italic" }
                    }, `Îã§Ïùå Í∞ïÌôî Ïãú Ïø®ÌÉÄÏûÑ ${currentCool}ÌÑ¥ ‚Üí ${currentCool - coolReduce}ÌÑ¥`)
                  )
                );
              })(),

              // Passive Skills
              passiveCount > 0 && React.createElement("div", null,
                React.createElement("div", {
                  style: { display: "flex", alignItems: "center", gap: "6px", marginBottom: "8px" }
                },
                  React.createElement("span", {
                    style: {
                      fontSize: "12px", fontWeight: 800, color: "#fff",
                      background: "#6b46c1", padding: "2px 8px", borderRadius: "4px",
                    }
                  }, "Ìå®ÏãúÎ∏å"),
                  !isSSGrade && React.createElement("span", {
                    style: { fontSize: "13px", color: "#718096" }
                  }, "Í∞ïÌôîÎ°ú ÏàòÏπò Í∞ïÌôî")
                ),
                ...skill.passives.slice(0, passiveCount).map((passive, pi) => {
                  // Enhanced logic: 
                  // B: 1 passive, enhanced at +1 (max)
                  // A: 1 passive, enhanced at +1 (max)
                  // S: 2 passives, first enhanced at +1, second at +2
                  // SS: always base (no enhance)
                  let isEnhanced = false;
                  if (!isSSGrade && passive.enhanced) {
                    if (passiveCount === 1) {
                      isEnhanced = enhance >= maxEnh;
                    } else if (passiveCount === 2) {
                      isEnhanced = enhance >= (pi + 1);
                    }
                  }
                  const currentDesc = isEnhanced ? passive.enhanced : passive.base;

                  return React.createElement("div", {
                    key: pi,
                    style: {
                      padding: "10px 12px", borderRadius: "10px",
                      background: isEnhanced ? "rgba(107,70,193,0.15)" : "rgba(107,70,193,0.06)",
                      border: isEnhanced ? "1px solid rgba(107,70,193,0.4)" : "1px solid rgba(107,70,193,0.15)",
                      marginBottom: "6px",
                    }
                  },
                    React.createElement("div", {
                      style: { display: "flex", alignItems: "center", gap: "6px", marginBottom: "3px" }
                    },
                      React.createElement("span", {
                        style: { fontSize: "13px", fontWeight: 800, color: isEnhanced ? "#d6bcfa" : "#b4a5d0" }
                      }, passive.name),
                      isEnhanced && React.createElement("span", {
                        style: {
                          fontSize: "9px", fontWeight: 800, color: "#48bb78",
                          background: "rgba(72,187,120,0.15)", padding: "1px 5px", borderRadius: "3px",
                        }
                      }, "Í∞ïÌôîÎê®")
                    ),
                    React.createElement("div", {
                      style: { fontSize: "13px", color: isEnhanced ? "#a0aec0" : "#8a95a5", lineHeight: 1.5 }
                    }, currentDesc),
                    // Show upgrade preview
                    !isSSGrade && !isEnhanced && passive.enhanced && React.createElement("div", {
                      style: { fontSize: "11px", color: "#718096", marginTop: "4px", fontStyle: "italic" }
                    }, `Í∞ïÌôî +${passiveCount === 1 ? maxEnh : pi + 1} Ïãú ‚Üí ${passive.enhanced}`)
                  );
                })
              ),

              // Close button
              React.createElement("button", {
                onClick: () => setPetDetail(null),
                style: {
                  width: "100%", marginTop: "14px", padding: "10px",
                  borderRadius: "8px", border: `1px solid ${c.bg}44`,
                  background: "rgba(255,255,255,0.03)", color: "#a0aec0",
                  fontSize: "13px", fontWeight: 700, cursor: "pointer",
                  fontFamily: "'Noto Sans KR', sans-serif",
                }
              }, "Îã´Í∏∞")
            )
          );
        })(),

        // Fusion Selection Modal
        fusionSelect && (() => {
          const grade = fusionSelect.grade;
          const needed = FUSION_NEED[grade];
          const candidates = getFusionCandidates(grade);
          const selected = fusionSelect.selected;
          const nextG = GRADES[GRADES.indexOf(grade) + 1];
          const c = GRADE_COLORS[grade];
          const nc = GRADE_COLORS[nextG];

          const toggleSelect = (candidate) => {
            const isSelected = selected.find((s) => s.id === candidate.id);
            if (isSelected) {
              setFusionSelect({ ...fusionSelect, selected: selected.filter((s) => s.id !== candidate.id) });
            } else if (selected.length < needed) {
              setFusionSelect({ ...fusionSelect, selected: [...selected, candidate] });
            }
          };

          const canConfirm = selected.length === needed;

          return React.createElement("div", {
            style: {
              position: "fixed", inset: 0, zIndex: 1000,
              background: "rgba(0,0,0,0.9)", display: "flex", flexDirection: "column",
              alignItems: "center", justifyContent: "center",
            }
          },
            React.createElement("div", {
              style: {
                width: "100%", maxWidth: "420px", maxHeight: "80vh",
                display: "flex", flexDirection: "column", gap: "12px",
                padding: "20px 16px",
              }
            },
              // Header
              React.createElement("div", {
                style: { textAlign: "center" }
              },
                React.createElement("div", {
                  style: { color: nc.accent, fontSize: "16px", fontWeight: 800, fontFamily: "'Noto Sans KR', sans-serif", marginBottom: "4px" }
                }, "üîÆ Ìï©ÏÑ± Ïû¨Î£å ÏÑ†ÌÉù"),
                React.createElement("div", {
                  style: { display: "flex", alignItems: "center", gap: "6px", justifyContent: "center", marginBottom: "8px" }
                },
                  React.createElement(GradeBadge, { grade, size: "sm" }),
                  React.createElement("span", { style: { fontSize: "15px", color: "#a0aec0" } }, `√ó${needed}`),
                  React.createElement("span", { style: { fontSize: "15px", color: "#a0aec0" } }, "‚Üí"),
                  React.createElement(GradeBadge, { grade: nextG, size: "sm" }),
                  React.createElement("span", { style: { fontSize: "15px", color: "#a0aec0" } }, "ÎûúÎç§")
                ),
                React.createElement("div", {
                  style: { fontSize: "15px", color: selected.length === needed ? "#48bb78" : "#a0aec0", fontWeight: 700 }
                }, `${selected.length} / ${needed} ÏÑ†ÌÉù`)
              ),

              // Candidates grid
              React.createElement("div", {
                style: { overflowY: "auto", flex: 1, padding: "4px" }
              },
                React.createElement("div", {
                  style: { display: "flex", flexWrap: "wrap", gap: "8px", justifyContent: "center" }
                },
                  ...candidates.map((cand) => {
                    const isSelected = selected.find((s) => s.id === cand.id);
                    const selIdx = selected.findIndex((s) => s.id === cand.id);
                    const isFull = selected.length >= needed && !isSelected;
                    return React.createElement("div", {
                      key: cand.id,
                      onClick: () => !isFull || isSelected ? toggleSelect(cand) : null,
                      style: {
                        position: "relative",
                        cursor: isFull ? "default" : "pointer",
                        opacity: isFull ? 0.35 : 1,
                        transition: "all 0.2s",
                      }
                    },
                      React.createElement(PetCard, {
                        grade: cand.grade, idx: cand.idx, compact: true,
                        enhanceLevel: MAX_ENHANCE[cand.grade],
                        selected: !!isSelected,
                      }),
                      isSelected && React.createElement("div", {
                        style: {
                          position: "absolute", top: "-6px", left: "-6px",
                          width: "18px", height: "18px", borderRadius: "50%",
                          background: nc.accent, color: "#fff",
                          display: "flex", alignItems: "center", justifyContent: "center",
                          fontSize: "15px", fontWeight: 900,
                          boxShadow: `0 2px 8px ${nc.glow}`,
                        }
                      }, selIdx + 1)
                    );
                  })
                )
              ),

              // Buttons
              React.createElement("div", {
                style: { display: "flex", gap: "8px", justifyContent: "center", paddingTop: "8px" }
              },
                React.createElement("button", {
                  onClick: () => setFusionSelect(null),
                  style: {
                    padding: "10px 24px", borderRadius: "8px", border: "1px solid rgba(255,255,255,0.1)",
                    background: "rgba(255,255,255,0.05)", color: "#a0aec0",
                    fontSize: "13px", fontWeight: 700, cursor: "pointer",
                    fontFamily: "'Noto Sans KR', sans-serif",
                  }
                }, "Ï∑®ÏÜå"),
                React.createElement("button", {
                  onClick: () => canConfirm && doFusion(grade, selected),
                  disabled: !canConfirm,
                  style: {
                    padding: "10px 24px", borderRadius: "8px", border: "none",
                    background: canConfirm
                      ? `linear-gradient(135deg, ${nc.bg}, ${nc.accent})`
                      : "rgba(255,255,255,0.05)",
                    color: canConfirm ? "#fff" : "#4a5568",
                    fontSize: "15px", fontWeight: 800, cursor: canConfirm ? "pointer" : "default",
                    fontFamily: "'Noto Sans KR', sans-serif",
                    boxShadow: canConfirm ? `0 4px 12px ${nc.glow}` : "none",
                    opacity: canConfirm ? 1 : 0.5,
                  }
                }, `Ìï©ÏÑ±! (+${FEED_REWARD[grade]}üçñ)`)
              )
            )
          );
        })()
      );
    }

    // ============================================================
    // SHARD VERSION (Ï°∞Í∞Å Î≤ÑÏ†Ñ)
    // ============================================================

    const SHARD_GRADES = ["B", "A", "S", "SS"];
    const SHARD_PULL_RATES = { B: 0.55, A: 0.30, S: 0.12, SS: 0.03 };

    const SHARD_PET_EMOJIS = {
      B: ["üê∫", "ü¶ä", "üêª", "ü¶Å", "üêØ", "ü¶Ö", "ü¶à", "üêô"],
      A: ["üê≤", "ü¶Ñ", "ü¶á", "üêç", "ü¶Ç", "ü¶ë", "üêã", "ü¶è"],
      S: ["üî•", "‚ùÑÔ∏è", "‚ö°", "üåä", "üåë", "‚òÄÔ∏è"],
      SS: ["üëë", "üèÜ", "üí´"],
    };

    const SHARD_PET_NAMES = {
      B: ["ÎäëÎåÄ", "Ïó¨Ïö∞", "Í≥∞ÎèåÏù¥", "ÏÇ¨Ïûê", "Ìò∏ÎûëÏù¥", "ÎèÖÏàòÎ¶¨", "ÏÉÅÏñ¥", "Î¨∏Ïñ¥"],
      A: ["ÎìúÎûòÍ≥§Jr", "Ïú†ÎãàÏΩò", "Î∞ïÏ•êÏôï", "Î±ÄÌååÏù¥Ïñ¥", "Ï†ÑÍ∞àÏôï", "ÌÅ¨ÎùºÏºÑ", "Í≥†ÎûòÏôï", "ÏΩîÎøîÏÜå"],
      S: ["ÌôîÏóºÏàòÌò∏Ïûê", "ÎπôÍ≤∞Ï†ïÎ†π", "Î≤àÍ∞úÏÇ¨Ïûê", "Ìï¥ÏùºÏö©", "ÏïîÌùëÍ∏∞ÏÇ¨", "ÌÉúÏñëÏ°∞"],
      SS: ["Î∂àÎ©∏ÏùòÌîºÎãâÏä§", "Ï†àÎåÄÏòÅÎèÑ", "Ï≤úÎë•Ï†úÏôï"],
    };

    // Shards needed: first number = unlock, then each subsequent = level up
    // B: 10 unlock, 10 per level, max 5 ‚Üí total 50 shards
    // A: 20 unlock, 15 per level, max 5 ‚Üí total 80 shards
    // S: 40 unlock, 25 per level, max 5 ‚Üí total 140 shards
    // SS: 80 unlock, 50 per level, max 5 ‚Üí total 280 shards
    const SHARD_UNLOCK = { B: 10, A: 20, S: 40, SS: 80 };
    const SHARD_PER_LEVEL = { B: 10, A: 15, S: 25, SS: 50 };
    const SHARD_MAX_LEVEL = 5;

    // Shards per pull (random 1~3 for lower, 1~2 for higher)
    const SHARD_AMOUNT = { B: [2, 4], A: [2, 3], S: [1, 2], SS: [1, 1] };

    const SHARD_SKILLS = {
      B: [
        { active: { name: "ÎäëÎåÄÏùò Ïö∏Î∂ÄÏßñÏùå", desc: "3ÌÑ¥Í∞Ñ Í≥µÍ≤©Î†• 12% Ï¶ùÍ∞Ä", cooldown: 8 }, own: "Î≥¥Ïú† Ïãú Í≥µÍ≤©Î†• +1%", passives: [
          { lv: 2, desc: "Ïö∏Î∂ÄÏßñÏùå ÏßÄÏÜç Ï§ë Ïó∞ÏÜç Í≥µÍ≤© Ïãú 20% ÌôïÎ•†Î°ú Ï∂îÍ∞Ä ÌÉÄÍ≤©" },
          { lv: 4, desc: "Ïö∏Î∂ÄÏßñÏùå Ï¢ÖÎ£å Ïãú 30% ÌôïÎ•†Î°ú ÏßÄÏÜçÏãúÍ∞Ñ 1ÌÑ¥ Ïó∞Ïû•" }] },
        { active: { name: "ÌôòÏòÅ ÎèåÏßÑ", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 150%Ïùò Îç∞ÎØ∏ÏßÄ", cooldown: 7 }, own: "Î≥¥Ïú† Ïãú ÌöåÌîºÏú® +1%", passives: [
          { lv: 2, desc: "ÌîºÍ≤© Ïãú 20% ÌôïÎ•†Î°ú ÌôòÏòÅ ÎèåÏßÑ Ïø®ÌÉÄÏûÑ 2 Í∞êÏÜå" },
          { lv: 4, desc: "ÌôòÏòÅ ÎèåÏßÑ ÌÇ¨ Ïãú Îã§Ïùå ÌîºÍ≤© ÌöåÌîº ÌôïÏ†ï" }] },
        { active: { name: "Í≥∞Ïùò Ìè¨Ïòπ", desc: "3ÌÑ¥Í∞Ñ Î∞©Ïñ¥Î†• 20% Ï¶ùÍ∞Ä", cooldown: 9 }, own: "Î≥¥Ïú† Ïãú Î∞©Ïñ¥Î†• +1%", passives: [
          { lv: 2, desc: "HP 50% Ïù¥ÌïòÏùº Îïå Í≥∞Ïùò Ìè¨Ïòπ Î∞©Ïñ¥Î†• Ï¶ùÍ∞ÄÎüâ +15%" },
          { lv: 4, desc: "Í≥∞Ïùò Ìè¨Ïòπ ÏßÄÏÜç Ï§ë ÌîºÍ≤© Ïãú 10% ÌôïÎ•†Î°ú Ï†Å Í∏∞Ï†à 1ÌÑ¥" }] },
        { active: { name: "ÏôïÏùò Ìè¨Ìö®", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 80%Ïùò Îç∞ÎØ∏ÏßÄ", cooldown: 10 }, own: "Î≥¥Ïú† Ïãú Ï†Å Í≥µÍ≤©Î†• -1%", passives: [
          { lv: 2, desc: "ÏôïÏùò Ìè¨Ìö® Î∞úÎèô Ïãú 30% ÌôïÎ•†Î°ú Ï†Å Ï†ÑÏ≤¥ 1ÌÑ¥ Í∏∞Ï†à" },
          { lv: 4, desc: "Í∏∞Ï†àÏãúÌÇ® Ï†Å ÏàòÎßåÌÅº Ïø®ÌÉÄÏûÑ 1Ïî© Í∞êÏÜå" }] },
        { active: { name: "ÎßπÌò∏ ÏäµÍ≤©", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 180%Ïùò Îç∞ÎØ∏ÏßÄ", cooldown: 8 }, own: "Î≥¥Ïú† Ïãú ÏπòÎ™ÖÌÉÄ Îç∞ÎØ∏ÏßÄ +2%", passives: [
          { lv: 2, desc: "Ï†Å HP 30% Ïù¥ÌïòÏùº Îïå ÎßπÌò∏ ÏäµÍ≤© Îç∞ÎØ∏ÏßÄ 40% Ï¶ùÍ∞Ä" },
          { lv: 4, desc: "ÎßπÌò∏ ÏäµÍ≤© ÌÇ¨ Ïãú Ï¶âÏãú Ïø®ÌÉÄÏûÑ Ï¥àÍ∏∞Ìôî (ÌÑ¥Îãπ 1Ìöå)" }] },
        { active: { name: "Í∏âÍ∞ïÌïò", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 160%Ïùò Îç∞ÎØ∏ÏßÄ", cooldown: 7 }, own: "Î≥¥Ïú† Ïãú ÏπòÎ™ÖÌÉÄÏú® +1%", passives: [
          { lv: 2, desc: "Ï†ÑÌà¨ ÏãúÏûë ÌõÑ Ï≤´ Í∏âÍ∞ïÌïò ÏπòÎ™ÖÌÉÄ ÌôïÏ†ï" },
          { lv: 4, desc: "Í∏âÍ∞ïÌïò ÏπòÎ™ÖÌÉÄ Ïãú Îã§Ïùå ÌÑ¥ Í≥µÍ≤©Î†• 20% Ï¶ùÍ∞Ä" }] },
        { active: { name: "ÌîºÏùò Í¥ëÎûÄ", desc: "4ÌÑ¥Í∞Ñ Í≥µÍ≤©ÏÜçÎèÑ 15% Ï¶ùÍ∞Ä", cooldown: 9 }, own: "Î≥¥Ïú† Ïãú Í≥µÍ≤©ÏÜçÎèÑ +1%", passives: [
          { lv: 2, desc: "ÌîºÏùò Í¥ëÎûÄ ÏßÄÏÜç Ï§ë ÌÇ¨ ÌöçÎìù Ïãú HP 8% ÌöåÎ≥µ" },
          { lv: 4, desc: "ÌîºÏùò Í¥ëÎûÄ Ï¢ÖÎ£å Ïãú ÌÇ¨ ÏàòÏóê ÎπÑÎ°ÄÌï¥ Ïø®ÌÉÄÏûÑ Í∞êÏÜå" }] },
        { active: { name: "Î®πÎ¨º Î∂ÑÏÇ¨", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê 2ÌÑ¥Í∞Ñ Î™ÖÏ§ëÎ•† 15% Í∞êÏÜå", cooldown: 10 }, own: "Î≥¥Ïú† Ïãú ÌöåÌîºÏú® +1%", passives: [
          { lv: 2, desc: "Î®πÎ¨º Î∂ÑÏÇ¨ Ï†ÅÏ§ë Ïãú 25% ÌôïÎ•†Î°ú Îã§Ïùå ÌîºÍ≤© Î¨¥Ìö®" },
          { lv: 4, desc: "Ïã§Î™Ö ÏÉÅÌÉú Ï†Å Í≥µÍ≤© Ïãú Îç∞ÎØ∏ÏßÄ 25% Ï¶ùÍ∞Ä" }] },
      ],
      A: [
        { active: { name: "ÌôîÏóº Î∏åÎ†àÏä§", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 120%Ïùò ÌôîÏóº Îç∞ÎØ∏ÏßÄ", cooldown: 8 }, own: "Î≥¥Ïú† Ïãú ÌôîÏóº Îç∞ÎØ∏ÏßÄ +3%", passives: [
          { lv: 2, desc: "ÌôîÏóº Î∏åÎ†àÏä§ Ï†ÅÏ§ë Ïãú 30% ÌôïÎ•†Î°ú 2ÌÑ¥ ÌôîÏÉÅ" },
          { lv: 4, desc: "ÌôîÏÉÅ ÏÉÅÌÉú Ï†Å 3ÎßàÎ¶¨ Ïù¥ÏÉÅÏùº Îïå Îç∞ÎØ∏ÏßÄ 30% Ï¶ùÍ∞Ä" }] },
        { active: { name: "Ïã†ÏÑ±Ìïú ÎèåÏßÑ", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 200%Ïùò Îç∞ÎØ∏ÏßÄ + HP 10% ÌöåÎ≥µ", cooldown: 9 }, own: "Î≥¥Ïú† Ïãú HP ÌöåÎ≥µÎüâ +3%", passives: [
          { lv: 2, desc: "HP 30% Ïù¥ÌïòÏùº Îïå ÌöåÎ≥µÎüâ 2Î∞∞" },
          { lv: 4, desc: "HP 30% Ïù¥ÌïòÏùº Îïå Ïø®ÌÉÄÏûÑ 2 Í∞êÏÜå + Îç∞ÎØ∏ÏßÄ 30% Ï¶ùÍ∞Ä" }] },
        { active: { name: "ÏïîÌùë Ìè≠Î∞ú", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 100%Ïùò ÏïîÌùë Îç∞ÎØ∏ÏßÄ", cooldown: 7 }, own: "Î≥¥Ïú† Ïãú ÏïîÌùë Îç∞ÎØ∏ÏßÄ +3%", passives: [
          { lv: 2, desc: "ÏïîÌùë Ìè≠Î∞ú ÌÇ¨ Ïãú Ïø®ÌÉÄÏûÑ Ï¶âÏãú Ï¥àÍ∏∞Ìôî (ÌÑ¥Îãπ 1Ìöå)" },
          { lv: 4, desc: "ÏïîÌùë Ìè≠Î∞ú 2Ìöå Ïó∞ÏÜç ÏÇ¨Ïö© Ïãú Îç∞ÎØ∏ÏßÄ 50% Ï¶ùÍ∞Ä" }] },
        { active: { name: "ÎèÖÏïÑ Î¨ºÍ∏∞", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 170%Ïùò ÎèÖ Îç∞ÎØ∏ÏßÄ + 3ÌÑ¥ Ï§ëÎèÖ", cooldown: 8 }, own: "Î≥¥Ïú† Ïãú ÎèÖ Îç∞ÎØ∏ÏßÄ +3%", passives: [
          { lv: 2, desc: "Ï§ëÎèÖ ÏÉÅÌÉú Ï†Å ÌîºÍ≤© Ïãú 25% ÌôïÎ•†Î°ú Î∞òÍ≤©" },
          { lv: 4, desc: "Ï§ëÎèÖ 3ÌÑ¥ Í≤ΩÍ≥º Ïãú ÎèÖ Ìè≠Î∞ú (Í≥µÍ≤©Î†• 100% Ï∂îÍ∞Ä Îç∞ÎØ∏ÏßÄ)" }] },
        { active: { name: "ÎèÖÏπ® ÎÇúÏÇ¨", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 60%Ïùò Îç∞ÎØ∏ÏßÄ x4Ìöå", cooldown: 9 }, own: "Î≥¥Ïú† Ïãú Îã§Îã®ÌûàÌä∏ Îç∞ÎØ∏ÏßÄ +2%", passives: [
          { lv: 2, desc: "HP 30% Ïù¥Ìïò ÏßÑÏûÖ Ïãú 1Ìöå Î¨¥Ï†Å + Ïø®ÌÉÄÏûÑ Ï¥àÍ∏∞Ìôî" },
          { lv: 4, desc: "ÎèÖÏπ® ÎÇúÏÇ¨ 4ÌÉÄ Î™®Îëê Ï†ÅÏ§ë Ïãú Ï∂îÍ∞Ä 2ÌÉÄ" }] },
        { active: { name: "Ïã¨Ìï¥ Ìè¨Ïòπ", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 180%Ïùò Îç∞ÎØ∏ÏßÄ + 2ÌÑ¥ ÏÜçÎ∞ï", cooldown: 10 }, own: "Î≥¥Ïú† Ïãú ÏÜçÎ∞ï ÌôïÎ•† +3%", passives: [
          { lv: 2, desc: "ÏÜçÎ∞ï Ï†Å Í≥µÍ≤© Ïãú 30% ÌôïÎ•†Î°ú Í∞ôÏù¥ Í≥µÍ≤©" },
          { lv: 4, desc: "ÏÜçÎ∞ï Ï¢ÖÎ£å Ïãú ÎåÄÏÉÅÏóêÍ≤å Í≥µÍ≤©Î†• 80%Ïùò Ï∂îÍ∞Ä Îç∞ÎØ∏ÏßÄ" }] },
        { active: { name: "Ìï¥Î•ò Ï∂©Í≤©Ìåå", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 130%Ïùò ÏàòÏÜçÏÑ± Îç∞ÎØ∏ÏßÄ", cooldown: 9 }, own: "Î≥¥Ïú† Ïãú ÏàòÏÜçÏÑ± Îç∞ÎØ∏ÏßÄ +3%", passives: [
          { lv: 2, desc: "Ìï¥Î•ò Ï∂©Í≤©Ìåå ÌÇ¨ Ïãú ÎÇòÎ®∏ÏßÄ Ï†ÅÏóêÍ≤å 50% Ï∂îÍ∞Ä Îç∞ÎØ∏ÏßÄ" },
          { lv: 4, desc: "Ìï¥Î•ò Ï∂©Í≤©Ìåå Ï†ÅÏ§ë ÏàòÏóê ÎπÑÎ°ÄÌï¥ Îã§Ïùå Ïø®ÌÉÄÏûÑ Í∞êÏÜå" }] },
        { active: { name: "ÎèåÏßÑ", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 220%Ïùò Îç∞ÎØ∏ÏßÄ", cooldown: 10 }, own: "Î≥¥Ïú† Ïãú Í≥µÍ≤©Î†• +2%", passives: [
          { lv: 2, desc: "HP 50% Ïù¥ÌïòÏùº Îïå ÎèåÏßÑ Îç∞ÎØ∏ÏßÄ 40% Ï¶ùÍ∞Ä" },
          { lv: 4, desc: "ÎèåÏßÑ ÌÇ¨ Ïãú HP 10% ÌöåÎ≥µ + Îã§Ïùå ÎèåÏßÑ Í¥ÄÌÜµ" }] },
      ],
      S: [
        { active: { name: "ÌôîÏóº Ïã¨Ìåê", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 200%Ïùò ÌôîÏóº Îç∞ÎØ∏ÏßÄ + 3ÌÑ¥ ÌôîÏÉÅ", cooldown: 8 }, own: "Î≥¥Ïú† Ïãú ÌôîÏóº Îç∞ÎØ∏ÏßÄ +5%", passives: [
          { lv: 2, desc: "ÌîºÍ≤© Ïãú 20% ÌôïÎ•†Î°ú Í≥µÍ≤©ÏûêÏóêÍ≤å Î∞òÍ≤© (ÌôîÏóº Ïã¨Ìåê 30%)" },
          { lv: 3, desc: "ÌôîÏÉÅ 3ÎßàÎ¶¨ Ïù¥ÏÉÅÏùº Îïå ÌôîÏóº Ïã¨Ìåê Îç∞ÎØ∏ÏßÄ 50% Ï¶ùÍ∞Ä" },
          { lv: 5, desc: "ÌôîÏÉÅ ÏÉÅÌÉú Ï†Å ÏÇ¨Îßù Ïãú Ïù∏Ï†ë Ï†ÅÏóêÍ≤å ÌôîÏÉÅ Ï†ÑÏù¥" }] },
        { active: { name: "Ï†àÎåÄÏòÅÎèÑ", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 180%Ïùò ÎπôÍ≤∞ Îç∞ÎØ∏ÏßÄ + 30% ÎèôÍ≤∞", cooldown: 9 }, own: "Î≥¥Ïú† Ïãú ÎπôÍ≤∞ Îç∞ÎØ∏ÏßÄ +5%", passives: [
          { lv: 2, desc: "ÎèôÍ≤∞Îêú Ï†Å ÌîºÍ≤© Ïãú 25% ÌôïÎ•†Î°ú Ïù∏Ï†ë Ï†ÅÎèÑ ÎèôÍ≤∞" },
          { lv: 3, desc: "ÎèôÍ≤∞ Ìï¥Ï†ú Ïãú Í≥µÍ≤©Î†• 100%Ïùò ÎπôÍ≤∞ Ìè≠Î∞ú" },
          { lv: 5, desc: "Ï†àÎåÄÏòÅÎèÑ 2Ìöå ÏÇ¨Ïö©ÎßàÎã§ Îã§Ïùå ÎèôÍ≤∞ ÌôïÎ•† 100%" }] },
        { active: { name: "Ï≤úÎë• Í∞ïÌÉÄ", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 300%Ïùò Î≤àÍ∞ú Îç∞ÎØ∏ÏßÄ", cooldown: 7 }, own: "Î≥¥Ïú† Ïãú Î≤àÍ∞ú Îç∞ÎØ∏ÏßÄ +5%", passives: [
          { lv: 2, desc: "Ï£ºÏù∏Í≥µ Í≥µÍ≤© Ïãú 25% ÌôïÎ•†Î°ú Í∞ôÏù¥ Í≥µÍ≤© (40%)" },
          { lv: 3, desc: "Ï≤úÎë• Í∞ïÌÉÄ ÏπòÎ™ÖÌÉÄ Ïãú Îã§Ïùå ÌÑ¥ Î≤àÍ∞ú Ï∂îÍ∞Ä 50%" },
          { lv: 5, desc: "Ï≤úÎë• Í∞ïÌÉÄ 3Ìöå ÏÇ¨Ïö©ÎßàÎã§ Ï†ÑÏ≤¥ Í≥µÍ≤©ÏúºÎ°ú Î≥ÄÍ≤Ω" }] },
        { active: { name: "Ìï¥Ïùº", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 160%Ïùò ÏàòÏÜçÏÑ± Îç∞ÎØ∏ÏßÄ + HP 15% ÌöåÎ≥µ", cooldown: 10 }, own: "Î≥¥Ïú† Ïãú HP ÌöåÎ≥µÎüâ +5%", passives: [
          { lv: 2, desc: "Ìï¥Ïùº Î∞úÎèô Ïãú 3ÌÑ¥Í∞Ñ Îß§ ÌÑ¥ HP 3% Ï∂îÍ∞Ä ÌöåÎ≥µ" },
          { lv: 3, desc: "ÌöåÎ≥µÎê† Îïå 30% ÌôïÎ•†Î°ú Ìï¥Ïùº Ïø®ÌÉÄÏûÑ 1 Í∞êÏÜå" },
          { lv: 5, desc: "Ìï¥Ïùº HPÍ∞Ä ÏµúÎåÄÏπò ÎèÑÎã¨ Ïãú Ï¥àÍ≥ºÎ∂ÑÏùò 80% Î≥¥Ìò∏Îßâ Ï†ÑÌôò" }] },
        { active: { name: "ÏïîÌùë Ï∞∏Í≤©", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 280%Ïùò ÏïîÌùë Îç∞ÎØ∏ÏßÄ + Ìù°Ìòà 20%", cooldown: 8 }, own: "Î≥¥Ïú† Ïãú Ìù°ÌòàÎüâ +3%", passives: [
          { lv: 2, desc: "ÏïîÌùë Ï∞∏Í≤© ÌÇ¨ Ïãú HP 15% Ï∂îÍ∞Ä ÌöåÎ≥µ" },
          { lv: 3, desc: "ÏïîÌùë Ï∞∏Í≤© ÎåÄÏÉÅ 20% ÌôïÎ•†Î°ú 2ÌÑ¥ Í≥µÌè¨ (Í≥µÍ≤©Î†• 30% Í∞êÏÜå)" },
          { lv: 5, desc: "HP 100%Ïùº Îïå ÏïîÌùë Ï∞∏Í≤© Îç∞ÎØ∏ÏßÄ 60% Ï¶ùÍ∞Ä" }] },
        { active: { name: "ÌÉúÏñë ÏÑ¨Í¥ë", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 190%Ïùò Í¥ëÏÜçÏÑ± Îç∞ÎØ∏ÏßÄ + Ïã§Î™Ö 2ÌÑ¥", cooldown: 9 }, own: "Î≥¥Ïú† Ïãú Í¥ëÏÜçÏÑ± Îç∞ÎØ∏ÏßÄ +5%", passives: [
          { lv: 2, desc: "ÎØ∏ÏÇ¨Ïö© 3ÌÑ¥ Í≤ΩÍ≥º Ïãú Îã§Ïùå Îç∞ÎØ∏ÏßÄ 50% Ï¶ùÍ∞Ä" },
          { lv: 3, desc: "Ïã§Î™Ö Ï†Å Í≥µÍ≤© Ïãú 30% ÌôïÎ•†Î°ú ÌòëÍ≥µ" },
          { lv: 5, desc: "ÌÉúÏñë ÏÑ¨Í¥ë Î∞úÎèô Ïãú Ïã§Î™Ö Ï†Å ÏàòÎßåÌÅº Ïø®ÌÉÄÏûÑ Í∞êÏÜå" }] },
      ],
      SS: [
        { active: { name: "Î∂àÎ©∏Ïùò Î∂àÍΩÉ", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 350%Ïùò ÌôîÏóº Îç∞ÎØ∏ÏßÄ + Î∂ÄÌôú 1Ìöå", cooldown: 10 }, own: "Î≥¥Ïú† Ïãú Ï†ÑÏ≤¥ Îç∞ÎØ∏ÏßÄ +5%", passives: [
          { lv: 2, desc: "ÏÇ¨Îßù Ïãú 1Ìöå HP 30% Î∂ÄÌôú + Î∂àÎ©∏Ïùò Î∂àÍΩÉ Ï¶âÏãú Î∞úÎèô" },
          { lv: 3, desc: "Î∂àÎ©∏Ïùò Î∂àÍΩÉ ÌôîÏÉÅÏùÄ Ìï¥Ï†ú Î∂àÍ∞Ä + Îß§ ÌÑ¥ Îç∞ÎØ∏ÏßÄ 10% Ï¶ùÍ∞Ä" },
          { lv: 5, desc: "Î∂ÄÌôú Î∞úÎèô ÌõÑ 3ÌÑ¥Í∞Ñ Î∞õÎäî Îç∞ÎØ∏ÏßÄ 50% Í∞êÏÜå" }] },
        { active: { name: "ÎπôÌïòÍ∏∞", desc: "Ï†Å Ï†ÑÏ≤¥Ïóê Í≥µÍ≤©Î†• 300%Ïùò ÎπôÍ≤∞ Îç∞ÎØ∏ÏßÄ + 50% ÎèôÍ≤∞ 2ÌÑ¥", cooldown: 10 }, own: "Î≥¥Ïú† Ïãú Ï†ÑÏ≤¥ Îç∞ÎØ∏ÏßÄ +5%", passives: [
          { lv: 2, desc: "ÎèôÍ≤∞ Ï†Å ÏÇ¨Îßù Ïãú Ïù∏Ï†ë Ï†Å ÎèôÍ≤∞ Ï†ÑÏù¥ + ÎπôÍ≤∞ Ìè≠Î∞ú" },
          { lv: 3, desc: "ÎπôÌïòÍ∏∞ Î∞úÎèô ÌõÑ 3ÌÑ¥Í∞Ñ ÌîºÍ≤© Ïãú Í≥µÍ≤©Ïûê 30% ÎèôÍ≤∞" },
          { lv: 5, desc: "ÎèôÍ≤∞ Ï†Å 5ÎßàÎ¶¨ ÎàÑÏ†Å Ïãú Îã§Ïùå ÎπôÌïòÍ∏∞ Ï†ÑÏ≤¥ ÎèôÍ≤∞ ÌôïÏ†ï" }] },
        { active: { name: "ÎáåÏ†úÏùò Ïã¨Ìåê", desc: "Ï†ÅÏóêÍ≤å Í≥µÍ≤©Î†• 500%Ïùò Î≤àÍ∞ú Îç∞ÎØ∏ÏßÄ (ÏπòÎ™ÖÌÉÄ Ïãú 2Î∞∞)", cooldown: 9 }, own: "Î≥¥Ïú† Ïãú ÏπòÎ™ÖÌÉÄÏú® +5%", passives: [
          { lv: 2, desc: "ÌîºÍ≤© Ïãú 40% ÌôïÎ•†Î°ú Î≤àÍ∞ú Î∞òÍ≤© (Í≥µÍ≤©Î†• 80%)" },
          { lv: 3, desc: "ÎáåÏ†úÏùò Ïã¨Ìåê 3ÌöåÎßàÎã§ Ï†ÑÏ≤¥ Í≥µÍ≤© + Îç∞ÎØ∏ÏßÄ 50% Ï¶ùÍ∞Ä" },
          { lv: 5, desc: "ÏπòÎ™ÖÌÉÄ Î∞úÏÉù Ïãú 20% ÌôïÎ•†Î°ú ÎáåÏ†úÏùò Ïã¨Ìåê Ïø®ÌÉÄÏûÑ Ï¥àÍ∏∞Ìôî" }] },
      ],
    };

    function createShardInventory() {
      const inv = {};
      SHARD_GRADES.forEach((g) => {
        SHARD_PET_NAMES[g].forEach((_, i) => {
          inv[`${g}_${i}`] = { grade: g, idx: i, shards: 0, level: 0 };
        });
      });
      return inv;
    }

    function shardPullOne() {
      const r = Math.random();
      let cum = 0;
      for (const [grade, rate] of Object.entries(SHARD_PULL_RATES)) {
        cum += rate;
        if (r < cum) {
          const idx = Math.floor(Math.random() * SHARD_PET_NAMES[grade].length);
          const [minAmt, maxAmt] = SHARD_AMOUNT[grade];
          const amount = minAmt + Math.floor(Math.random() * (maxAmt - minAmt + 1));
          return { grade, idx, amount };
        }
      }
      return { grade: "B", idx: 0, amount: 2 };
    }

    // Shard PetCard
    const ShardPetCard = ({ grade, idx, level, shards, onClick, compact, showShards }) => {
      const c = GRADE_COLORS[grade];
      const emoji = SHARD_PET_EMOJIS[grade][idx];
      const name = SHARD_PET_NAMES[grade][idx];
      const unlocked = level > 0;
      const unlockCost = SHARD_UNLOCK[grade];
      const nextCost = level === 0 ? unlockCost : SHARD_PER_LEVEL[grade];
      const isMax = level >= SHARD_MAX_LEVEL;
      const progress = isMax ? 1 : (level === 0 ? shards / unlockCost : (shards % SHARD_PER_LEVEL[grade]) / SHARD_PER_LEVEL[grade]);

      // Calculate total shards needed for current level threshold
      const currentThreshold = level === 0 ? unlockCost : unlockCost + level * SHARD_PER_LEVEL[grade];
      const nextThreshold = isMax ? currentThreshold : (level === 0 ? unlockCost : currentThreshold + SHARD_PER_LEVEL[grade]);
      const shardsInLevel = isMax ? 0 : shards - (level === 0 ? 0 : unlockCost + (level - 1) * SHARD_PER_LEVEL[grade]);
      const shardsNeeded = isMax ? 0 : nextCost;
      const progressReal = isMax ? 1 : Math.max(0, Math.min(1, shardsInLevel / shardsNeeded));

      return React.createElement("div", {
        onClick,
        style: {
          position: "relative",
          width: compact ? "80px" : "96px",
          padding: compact ? "7px 5px" : "9px 7px",
          borderRadius: "10px",
          background: unlocked
            ? `linear-gradient(145deg, ${c.bg}22, ${c.bg}44)`
            : "linear-gradient(145deg, rgba(255,255,255,0.02), rgba(255,255,255,0.05))",
          border: `1px solid ${unlocked ? c.bg + "55" : "rgba(255,255,255,0.08)"}`,
          cursor: onClick ? "pointer" : "default",
          textAlign: "center", flexShrink: 0,
          opacity: unlocked ? 1 : 0.6,
        }
      },
        React.createElement("div", {
          style: { fontSize: compact ? "28px" : "36px", lineHeight: 1, filter: unlocked ? "none" : "grayscale(0.7)" }
        }, emoji),
        React.createElement("div", {
          style: { fontSize: "11px", color: unlocked ? c.text : "#4a5568", marginTop: "3px", fontWeight: 600, whiteSpace: "nowrap", overflow: "hidden", textOverflow: "ellipsis" }
        }, name),
        // Level or locked
        React.createElement("div", {
          style: { display: "flex", gap: "3px", justifyContent: "center", marginTop: "3px", alignItems: "center" }
        },
          React.createElement(GradeBadge, { grade, size: "xs" }),
          React.createElement("span", {
            style: { fontSize: "10px", fontWeight: 700, color: isMax ? "#48bb78" : unlocked ? "#f6e05e" : "#4a5568" }
          }, isMax ? "MAX" : unlocked ? `Lv.${level}` : "ÎØ∏Ìï¥Í∏à")
        ),
        // Shard progress bar
        showShards && React.createElement("div", { style: { marginTop: "4px" } },
          React.createElement("div", {
            style: { height: "3px", borderRadius: "2px", background: "rgba(255,255,255,0.1)" }
          },
            React.createElement("div", {
              style: {
                width: `${progressReal * 100}%`, height: "100%", borderRadius: "2px",
                background: isMax ? "#48bb78" : unlocked ? c.accent : "#4a5568",
                transition: "width 0.3s",
              }
            })
          ),
          React.createElement("div", {
            style: { fontSize: "9px", color: "#718096", marginTop: "1px" }
          }, isMax ? "ÎßåÎ†ô" : `${Math.max(0, shardsInLevel)}/${shardsNeeded}`)
        )
      );
    };

    // Shard Detail Popup
    const ShardDetailPopup = ({ pet, onClose }) => {
      if (!pet) return null;
      const { grade, idx, level, shards } = pet;
      const c = GRADE_COLORS[grade];
      const skill = SHARD_SKILLS[grade][idx];
      const unlockCost = SHARD_UNLOCK[grade];
      const perLevel = SHARD_PER_LEVEL[grade];

      return React.createElement("div", {
        onClick: (e) => { if (e.target === e.currentTarget) onClose(); },
        style: {
          position: "fixed", inset: 0, zIndex: 1000,
          background: "rgba(0,0,0,0.88)", display: "flex",
          alignItems: "center", justifyContent: "center", padding: "16px",
        }
      },
        React.createElement("div", {
          style: {
            width: "100%", maxWidth: "360px", maxHeight: "80vh", overflowY: "auto",
            borderRadius: "16px",
            background: `linear-gradient(160deg, #1a202c, ${c.bg}15, #1a202c)`,
            border: `1px solid ${c.bg}55`,
            boxShadow: `0 0 40px ${c.glow}`,
            padding: "20px",
          }
        },
          // Header
          React.createElement("div", { style: { textAlign: "center", marginBottom: "16px" } },
            React.createElement("div", {
              style: { fontSize: "56px", lineHeight: 1, marginBottom: "8px", filter: `drop-shadow(0 0 16px ${c.glow})` }
            }, SHARD_PET_EMOJIS[grade][idx]),
            React.createElement("div", {
              style: { display: "flex", alignItems: "center", gap: "6px", justifyContent: "center", marginBottom: "4px" }
            },
              React.createElement(GradeBadge, { grade, size: "md" }),
              React.createElement("span", { style: { fontSize: "18px", fontWeight: 900, color: c.text } }, SHARD_PET_NAMES[grade][idx])
            ),
            React.createElement("div", {
              style: { fontSize: "14px", color: level >= SHARD_MAX_LEVEL ? "#48bb78" : level > 0 ? "#f6e05e" : "#718096", fontWeight: 700 }
            }, level >= SHARD_MAX_LEVEL ? "‚ú® MAX LEVEL" : level > 0 ? `Lv.${level} / ${SHARD_MAX_LEVEL}` : "üîí ÎØ∏Ìï¥Í∏à"),
            React.createElement("div", {
              style: { fontSize: "12px", color: "#718096", marginTop: "2px" }
            }, `Ï°∞Í∞Å: ${shards}Í∞ú`)
          ),
          React.createElement("div", { style: { height: "1px", background: `${c.bg}44`, marginBottom: "14px" } }),

          // Own effect
          React.createElement("div", { style: { marginBottom: "12px" } },
            React.createElement("div", { style: { display: "flex", alignItems: "center", gap: "6px", marginBottom: "6px" } },
              React.createElement("span", {
                style: { fontSize: "11px", fontWeight: 800, color: "#fff", background: "#38a169", padding: "2px 8px", borderRadius: "4px" }
              }, "Î≥¥Ïú†Ìö®Í≥º")
            ),
            React.createElement("div", {
              style: {
                padding: "8px 12px", borderRadius: "8px",
                background: level > 0 ? "rgba(56,161,105,0.1)" : "rgba(255,255,255,0.02)",
                border: `1px solid ${level > 0 ? "rgba(56,161,105,0.3)" : "rgba(255,255,255,0.05)"}`,
              }
            },
              React.createElement("div", {
                style: { fontSize: "13px", color: level > 0 ? "#68d391" : "#718096" }
              }, level > 0 ? skill.own + ` (√óLv.${level})` : skill.own + " (Ìï¥Í∏à ÌïÑÏöî)")
            )
          ),

          // Active
          React.createElement("div", { style: { marginBottom: "12px" } },
            React.createElement("div", { style: { display: "flex", alignItems: "center", gap: "6px", marginBottom: "6px" } },
              React.createElement("span", {
                style: { fontSize: "11px", fontWeight: 800, color: "#fff", background: c.accent, padding: "2px 8px", borderRadius: "4px" }
              }, "Ïï°Ìã∞Î∏å"),
              React.createElement("span", {
                style: { fontSize: "12px", color: "#718096" }
              }, `Ïø®ÌÉÄÏûÑ ${skill.active.cooldown - Math.floor(level / 3)}ÌÑ¥${level >= 3 ? ` (${skill.active.cooldown}‚Üí${skill.active.cooldown - Math.floor(level / 3)})` : ""}`)
            ),
            React.createElement("div", {
              style: { padding: "8px 12px", borderRadius: "8px", background: `${c.bg}22`, border: `1px solid ${c.bg}33` }
            },
              React.createElement("div", { style: { fontSize: "14px", fontWeight: 800, color: c.text, marginBottom: "4px" } }, skill.active.name),
              React.createElement("div", { style: { fontSize: "13px", color: "#a0aec0", lineHeight: 1.5 } }, skill.active.desc),
              level < 3 && React.createElement("div", {
                style: { fontSize: "11px", color: "#718096", marginTop: "4px", fontStyle: "italic" }
              }, `Lv.3 ÎèÑÎã¨ Ïãú Ïø®ÌÉÄÏûÑ -1`)
            )
          ),

          // Passives
          skill.passives.length > 0 && React.createElement("div", null,
            React.createElement("div", { style: { display: "flex", alignItems: "center", gap: "6px", marginBottom: "6px" } },
              React.createElement("span", {
                style: { fontSize: "11px", fontWeight: 800, color: "#fff", background: "#6b46c1", padding: "2px 8px", borderRadius: "4px" }
              }, "Ìå®ÏãúÎ∏å"),
              React.createElement("span", { style: { fontSize: "12px", color: "#718096" } }, "Î†àÎ≤®ÏóÖÏúºÎ°ú Ìï¥Í∏à")
            ),
            ...skill.passives.map((p, pi) => {
              const unlocked = level >= p.lv;
              return React.createElement("div", {
                key: pi,
                style: {
                  padding: "8px 12px", borderRadius: "8px", marginBottom: "6px",
                  background: unlocked ? "rgba(107,70,193,0.12)" : "rgba(107,70,193,0.04)",
                  border: `1px solid ${unlocked ? "rgba(107,70,193,0.35)" : "rgba(107,70,193,0.1)"}`,
                }
              },
                React.createElement("div", { style: { display: "flex", alignItems: "center", gap: "6px", marginBottom: "2px" } },
                  React.createElement("span", {
                    style: { fontSize: "10px", fontWeight: 800, color: unlocked ? "#d6bcfa" : "#718096", background: unlocked ? "rgba(107,70,193,0.2)" : "rgba(255,255,255,0.05)", padding: "1px 6px", borderRadius: "3px" }
                  }, `Lv.${p.lv}`),
                  unlocked && React.createElement("span", {
                    style: { fontSize: "9px", fontWeight: 800, color: "#48bb78", background: "rgba(72,187,120,0.15)", padding: "1px 5px", borderRadius: "3px" }
                  }, "Ìï¥Í∏àÎê®")
                ),
                React.createElement("div", {
                  style: { fontSize: "13px", color: unlocked ? "#a0aec0" : "#5a6577", lineHeight: 1.5 }
                }, p.desc)
              );
            })
          ),

          React.createElement("button", {
            onClick: onClose,
            style: {
              width: "100%", marginTop: "14px", padding: "10px", borderRadius: "8px",
              border: `1px solid ${c.bg}44`, background: "rgba(255,255,255,0.03)",
              color: "#a0aec0", fontSize: "13px", fontWeight: 700, cursor: "pointer",
              fontFamily: "'Noto Sans KR', sans-serif",
            }
          }, "Îã´Í∏∞")
        )
      );
    };

    function ShardApp() {
      const [inventory, setInventory] = useState(createShardInventory);
      const [universalShards, setUniversalShards] = useState(0);
      const [tab, setTab] = useState("pull");
      const [pullResult, setPullResult] = useState(null);
      const [petDetail, setPetDetail] = useState(null);
      const [totalPulls, setTotalPulls] = useState(0);
      const [log, setLog] = useState([]);
      const logRef = useRef(null);

      const addLog = useCallback((msg) => {
        setLog((prev) => [...prev.slice(-50), { msg, time: Date.now() }]);
      }, []);

      useEffect(() => {
        if (logRef.current) logRef.current.scrollTop = logRef.current.scrollHeight;
      }, [log]);

      // Add shards and handle level ups
      const addShards = useCallback((grade, idx, amount, inv) => {
        const key = `${grade}_${idx}`;
        const pet = { ...inv[key] };
        pet.shards += amount;
        const unlockCost = SHARD_UNLOCK[grade];
        const perLevel = SHARD_PER_LEVEL[grade];
        let leveledUp = false;
        let newLevel = pet.level;
        let universalGain = 0;

        // Check level ups
        while (true) {
          if (newLevel === 0) {
            if (pet.shards >= unlockCost) {
              newLevel = 1;
              leveledUp = true;
            } else break;
          } else if (newLevel < SHARD_MAX_LEVEL) {
            const threshold = unlockCost + newLevel * perLevel;
            if (pet.shards >= threshold) {
              newLevel++;
              leveledUp = true;
            } else break;
          } else {
            // Max level - convert excess to universal
            const maxThreshold = unlockCost + (SHARD_MAX_LEVEL - 1) * perLevel;
            // Already at max, keep shards at max threshold level
            break;
          }
        }

        // If max and has excess shards, convert to universal
        if (newLevel >= SHARD_MAX_LEVEL) {
          const maxShards = unlockCost + (SHARD_MAX_LEVEL - 1) * perLevel;
          if (pet.shards > maxShards) {
            universalGain = pet.shards - maxShards;
            pet.shards = maxShards;
          }
        }

        pet.level = newLevel;
        return { inv: { ...inv, [key]: pet }, leveledUp, newLevel, universalGain };
      }, []);

      const doPull = useCallback((count) => {
        const results = [];
        let newInv = { ...inventory };
        for (const key of Object.keys(newInv)) {
          newInv[key] = { ...newInv[key] };
        }
        let totalUniversal = 0;

        for (let i = 0; i < count; i++) {
          const pull = shardPullOne();
          const { inv, leveledUp, newLevel, universalGain } = addShards(pull.grade, pull.idx, pull.amount, newInv);
          newInv = inv;
          totalUniversal += universalGain;
          results.push({ ...pull, leveledUp, newLevel });
        }

        setInventory(newInv);
        if (totalUniversal > 0) setUniversalShards((u) => u + totalUniversal);
        setTotalPulls((p) => p + count);
        setPullResult(results);

        const summary = {};
        results.forEach((r) => { summary[r.grade] = (summary[r.grade] || 0) + 1; });
        const summaryStr = Object.entries(summary).map(([g, c]) => `${g}√ó${c}`).join(" ");
        addLog(`üé∞ ${count}Ïó∞Ï∞® ÎΩëÍ∏∞: ${summaryStr}`);
      }, [inventory, addShards, addLog]);

      const tabsData = [
        { id: "pull", label: "üé∞ ÎΩëÍ∏∞", color: "#f6ad55" },
        { id: "collection", label: "üì¶ ÎèÑÍ∞ê", color: "#63b3ed" },
        { id: "shop", label: "üè™ ÏÉÅÏ†ê", color: "#68d391" },
      ];

      const stats = useMemo(() => {
        const counts = {};
        SHARD_GRADES.forEach((g) => {
          let unlocked = 0;
          SHARD_PET_NAMES[g].forEach((_, i) => {
            if (inventory[`${g}_${i}`].level > 0) unlocked++;
          });
          counts[g] = { unlocked, total: SHARD_PET_NAMES[g].length };
        });
        return counts;
      }, [inventory]);

      // Pull result overlay
      const renderPullResult = () => {
        if (!pullResult) return null;
        return React.createElement("div", {
          onClick: () => setPullResult(null),
          style: {
            position: "fixed", inset: 0, zIndex: 1000,
            background: "rgba(0,0,0,0.9)", display: "flex", flexDirection: "column",
            alignItems: "center", justifyContent: "center", gap: "16px",
          }
        },
          React.createElement("div", {
            style: { color: "#f6e05e", fontSize: "16px", fontWeight: 700, fontFamily: "'Noto Sans KR', sans-serif" }
          }, `üé∞ ${pullResult.length}Ïó∞Ï∞® Í≤∞Í≥º`),
          React.createElement("div", {
            style: { display: "flex", flexWrap: "wrap", gap: "8px", justifyContent: "center", maxWidth: "420px", padding: "0 12px" }
          },
            ...pullResult.map((r, i) => {
              const rc = GRADE_COLORS[r.grade];
              return React.createElement("div", {
                key: i,
                style: { animation: "popIn 0.3s ease-out", animationDelay: `${i * 0.06}s`, animationFillMode: "both", textAlign: "center" }
              },
                React.createElement("div", {
                  style: {
                    width: "72px", padding: "6px 4px", borderRadius: "10px",
                    background: `linear-gradient(145deg, ${rc.bg}22, ${rc.bg}44)`,
                    border: `1px solid ${rc.bg}55`,
                  }
                },
                  React.createElement("div", { style: { fontSize: "24px", lineHeight: 1 } }, SHARD_PET_EMOJIS[r.grade][r.idx]),
                  React.createElement("div", { style: { fontSize: "10px", color: rc.text, marginTop: "2px", fontWeight: 600 } }, SHARD_PET_NAMES[r.grade][r.idx]),
                  React.createElement("div", { style: { display: "flex", gap: "3px", justifyContent: "center", marginTop: "2px", alignItems: "center" } },
                    React.createElement(GradeBadge, { grade: r.grade, size: "xs" }),
                    React.createElement("span", { style: { fontSize: "10px", color: "#f6e05e", fontWeight: 700 } }, `+${r.amount}`)
                  ),
                  r.leveledUp && React.createElement("div", {
                    style: { fontSize: "9px", fontWeight: 800, color: r.newLevel === 1 ? "#fc8181" : "#f6e05e", marginTop: "2px" }
                  }, r.newLevel === 1 ? "üÜï Ìï¥Í∏à!" : `‚¨Ü Lv.${r.newLevel}`)
                )
              );
            })
          ),
          // Level up summary
          (() => {
            const levelUps = pullResult.filter((r) => r.leveledUp);
            if (levelUps.length === 0) return null;
            return React.createElement("div", {
              style: {
                padding: "8px 14px", borderRadius: "10px",
                background: "rgba(246,224,94,0.08)", border: "1px solid rgba(246,224,94,0.15)",
              }
            },
              React.createElement("div", { style: { fontSize: "11px", color: "#f6e05e", fontWeight: 700, textAlign: "center" } },
                `‚¨Ü ${levelUps.filter((r) => r.newLevel === 1).length > 0 ? "ÏÉà Ìé´ Ìï¥Í∏à! " : ""}${levelUps.length}Í±¥ Î†àÎ≤®ÏóÖ`
              )
            );
          })(),
          React.createElement("div", {
            style: { color: "#718096", fontSize: "13px", fontFamily: "'Noto Sans KR', sans-serif" }
          }, "ÌÉ≠ÌïòÏó¨ Îã´Í∏∞")
        );
      };

      return React.createElement("div", {
        style: {
          height: "100%", width: "100%",
          fontFamily: "'Noto Sans KR', -apple-system, sans-serif",
          color: "#e2e8f0", display: "flex", flexDirection: "column",
        }
      },
        // Header
        React.createElement("div", {
          style: {
            padding: "12px 16px",
            background: "linear-gradient(90deg, rgba(99,179,237,0.08), rgba(183,148,244,0.08), rgba(252,129,129,0.08))",
            borderBottom: "1px solid rgba(255,255,255,0.05)",
            display: "flex", alignItems: "center", justifyContent: "space-between",
          }
        },
          React.createElement("div", null,
            React.createElement("div", { style: { fontSize: "18px", fontWeight: 900, letterSpacing: "-0.5px" } }, "üêæ Ìé´ ÏãúÏä§ÌÖú (Ï°∞Í∞Å Î≤ÑÏ†Ñ)"),
            React.createElement("div", { style: { fontSize: "11px", color: "#718096", marginTop: "2px" } }, `Ï¥ù ${totalPulls}Ìöå ÎΩëÍ∏∞`)
          ),
          React.createElement("div", { style: { display: "flex", alignItems: "center", gap: "6px" } },
            React.createElement("span", { style: { fontSize: "15px" } }, "üíé"),
            React.createElement("span", { style: { fontSize: "15px", fontWeight: 800, color: "#63b3ed" } }, universalShards)
          )
        ),
        // Tabs
        React.createElement("div", {
          style: { display: "flex", borderBottom: "1px solid rgba(255,255,255,0.05)", background: "rgba(0,0,0,0.2)" }
        },
          ...tabsData.map((t) =>
            React.createElement("button", {
              key: t.id, onClick: () => setTab(t.id),
              style: {
                flex: 1, padding: "10px 0", border: "none",
                background: tab === t.id ? `${t.color}15` : "transparent",
                color: tab === t.id ? t.color : "#4a5568",
                fontSize: "13px", fontWeight: 700, cursor: "pointer",
                borderBottom: tab === t.id ? `2px solid ${t.color}` : "2px solid transparent",
                fontFamily: "'Noto Sans KR', sans-serif",
              }
            }, t.label)
          )
        ),
        // Content
        React.createElement("div", {
          style: { flex: 1, overflowY: "auto", padding: "16px" }
        },
          // Pull tab
          tab === "pull" && React.createElement("div", {
            style: { display: "flex", flexDirection: "column", alignItems: "center", gap: "16px" }
          },
            React.createElement("div", { style: { fontSize: "56px", marginBottom: "16px" } }, "üé∞"),
            React.createElement("div", { style: { fontSize: "13px", color: "#a0aec0", marginBottom: "20px" } }, "Ìé´ Ï°∞Í∞ÅÏùÑ ÎΩëÏïÑ Ìé´ÏùÑ Ìï¥Í∏àÌïòÍ≥† Î†àÎ≤®ÏóÖÌïòÏÑ∏Ïöî!"),
            React.createElement("div", { style: { display: "flex", gap: "12px" } },
              React.createElement("button", {
                onClick: () => doPull(1),
                style: {
                  padding: "14px 28px", borderRadius: "12px", border: "none",
                  background: "linear-gradient(135deg, #f6ad55, #ed8936)", color: "#fff",
                  fontSize: "15px", fontWeight: 800, cursor: "pointer", fontFamily: "'Noto Sans KR', sans-serif",
                  boxShadow: "0 4px 15px rgba(237,137,54,0.3)",
                }
              }, "1Ïó∞Ï∞®"),
              React.createElement("button", {
                onClick: () => doPull(10),
                style: {
                  padding: "14px 28px", borderRadius: "12px", border: "none",
                  background: "linear-gradient(135deg, #b794f4, #805ad5)", color: "#fff",
                  fontSize: "15px", fontWeight: 800, cursor: "pointer", fontFamily: "'Noto Sans KR', sans-serif",
                  boxShadow: "0 4px 15px rgba(128,90,213,0.3)",
                }
              }, "10Ïó∞Ï∞®")
            ),
            // Pull rates
            React.createElement("div", {
              style: { width: "100%", maxWidth: "300px", marginTop: "12px" }
            },
              React.createElement("div", { style: { fontSize: "12px", fontWeight: 700, color: "#718096", marginBottom: "8px" } }, "Îì±Í∏âÎ≥Ñ ÌôïÎ•†"),
              ...SHARD_GRADES.map((g) => {
                const r = SHARD_PULL_RATES[g];
                return React.createElement("div", {
                  key: g,
                  style: { display: "flex", alignItems: "center", gap: "6px", marginBottom: "4px" }
                },
                  React.createElement(GradeBadge, { grade: g, size: "xs" }),
                  React.createElement("div", { style: { flex: 1, height: "6px", borderRadius: "3px", background: "rgba(255,255,255,0.05)" } },
                    React.createElement("div", { style: { width: `${r * 100}%`, height: "100%", borderRadius: "3px", background: GRADE_COLORS[g].accent } })
                  ),
                  React.createElement("span", { style: { fontSize: "12px", color: "#a0aec0", width: "36px", textAlign: "right" } }, `${(r * 100).toFixed(0)}%`)
                );
              })
            )
          ),
          // Collection tab
          tab === "collection" && React.createElement("div", {
            style: { display: "flex", flexDirection: "column", gap: "16px" }
          },
            ...[...SHARD_GRADES].reverse().map((g) => {
              const pets = SHARD_PET_NAMES[g].map((_, i) => inventory[`${g}_${i}`]);
              return React.createElement("div", { key: g },
                React.createElement("div", {
                  style: { display: "flex", alignItems: "center", gap: "6px", marginBottom: "8px", paddingBottom: "4px", borderBottom: `1px solid ${GRADE_COLORS[g].bg}33` }
                },
                  React.createElement(GradeBadge, { grade: g, size: "sm" }),
                  React.createElement("span", { style: { fontSize: "14px", fontWeight: 700, color: GRADE_COLORS[g].text } },
                    `${g}Îì±Í∏â (${stats[g].unlocked}/${stats[g].total})`)
                ),
                React.createElement("div", { style: { display: "flex", flexWrap: "wrap", gap: "6px" } },
                  ...pets.map((p, i) =>
                    React.createElement(ShardPetCard, {
                      key: i, grade: g, idx: i, level: p.level, shards: p.shards,
                      compact: true, showShards: true,
                      onClick: () => setPetDetail({ grade: g, idx: i, level: p.level, shards: p.shards }),
                    })
                  )
                )
              );
            })
          ),
          // Shop tab
          tab === "shop" && React.createElement("div", {
            style: { display: "flex", flexDirection: "column", gap: "12px" }
          },
            React.createElement("div", {
              style: { padding: "12px", borderRadius: "10px", background: "rgba(99,179,237,0.08)", border: "1px solid rgba(99,179,237,0.15)", display: "flex", alignItems: "center", justifyContent: "space-between" }
            },
              React.createElement("span", { style: { fontSize: "13px", color: "#a0aec0" } }, "Î≥¥Ïú† ÎßåÎä• Ï°∞Í∞Å"),
              React.createElement("span", { style: { fontSize: "20px", fontWeight: 900, color: "#63b3ed" } }, `üíé ${universalShards}`)
            ),
            React.createElement("div", { style: { fontSize: "12px", color: "#718096", marginBottom: "4px" } }, "ÎßåÎä• Ï°∞Í∞ÅÏúºÎ°ú ÏõêÌïòÎäî Ìé´ Ï°∞Í∞ÅÏùÑ ÍµêÌôòÌïòÏÑ∏Ïöî"),
            React.createElement("div", { style: { fontSize: "11px", color: "#4a5568", marginBottom: "8px" } }, "ÎßåÎ†ô Ìé´Ïùò Ï¥àÍ≥º Ï°∞Í∞ÅÏùÄ ÏûêÎèôÏúºÎ°ú ÎßåÎä• Ï°∞Í∞ÅÏúºÎ°ú Î≥ÄÌôòÎê©ÎãàÎã§"),
            ...SHARD_GRADES.map((g) =>
              React.createElement("div", { key: g },
                React.createElement("div", {
                  style: { fontSize: "12px", fontWeight: 700, color: GRADE_COLORS[g].text, marginBottom: "6px" }
                }, `${g}Îì±Í∏â (1Í∞úÎãπ ÎßåÎä• Ï°∞Í∞Å ${g === "B" ? 5 : g === "A" ? 10 : g === "S" ? 25 : 50}Í∞ú)`),
                React.createElement("div", { style: { display: "flex", flexWrap: "wrap", gap: "6px", marginBottom: "12px" } },
                  ...SHARD_PET_NAMES[g].map((name, i) => {
                    const cost = g === "B" ? 5 : g === "A" ? 10 : g === "S" ? 25 : 50;
                    const canBuy = universalShards >= cost;
                    return React.createElement("button", {
                      key: i,
                      onClick: () => {
                        if (!canBuy) return;
                        setUniversalShards((u) => u - cost);
                        const newInv = { ...inventory };
                        for (const k of Object.keys(newInv)) newInv[k] = { ...newInv[k] };
                        const { inv } = addShards(g, i, 1, newInv);
                        setInventory(inv);
                        addLog(`üè™ ÍµêÌôò: ${name} Ï°∞Í∞Å 1Í∞ú (-${cost} ÎßåÎä• Ï°∞Í∞Å)`);
                      },
                      style: {
                        padding: "6px 8px", borderRadius: "8px", border: "none",
                        background: canBuy ? `${GRADE_COLORS[g].bg}33` : "rgba(255,255,255,0.03)",
                        color: canBuy ? GRADE_COLORS[g].text : "#4a5568",
                        fontSize: "11px", fontWeight: 700, cursor: canBuy ? "pointer" : "default",
                        opacity: canBuy ? 1 : 0.5, fontFamily: "'Noto Sans KR', sans-serif",
                      }
                    }, `${SHARD_PET_EMOJIS[g][i]} ${name}`);
                  })
                )
              )
            )
          )
        ),
        // Log
        React.createElement("div", {
          style: { borderTop: "1px solid rgba(255,255,255,0.05)", background: "rgba(0,0,0,0.3)" }
        },
          React.createElement("div", { style: { padding: "6px 16px 4px", fontSize: "11px", fontWeight: 700, color: "#4a5568" } }, "üìú Î°úÍ∑∏"),
          React.createElement("div", {
            ref: logRef,
            style: { height: "50px", overflowY: "auto", padding: "0 16px 6px" }
          },
            ...log.map((l, i) =>
              React.createElement("div", { key: i, style: { fontSize: "11px", color: "#718096", lineHeight: 1.8 } }, l.msg)
            )
          )
        ),
        // Overlays
        renderPullResult(),
        petDetail && React.createElement(ShardDetailPopup, {
          pet: petDetail,
          onClose: () => setPetDetail(null),
        })
      );
    }

    // ============================================================
    // ROOT APP - Version Toggle
    // ============================================================
    function App() {
      const [version, setVersion] = useState("fusion");

      return React.createElement("div", {
        style: {
          height: "100vh", width: "100vw",
          background: "linear-gradient(180deg, #0a0e17 0%, #131a2e 50%, #0d1320 100%)",
          maxWidth: "480px", margin: "0 auto",
          display: "flex", flexDirection: "column",
          position: "relative",
        }
      },
        // Main content
        React.createElement("div", { style: { flex: 1, overflow: "hidden", display: "flex", flexDirection: "column" } },
          version === "fusion"
            ? React.createElement(FusionApp)
            : React.createElement(ShardApp)
        ),
        // Version toggle bar
        React.createElement("div", {
          style: {
            display: "flex",
            borderTop: "2px solid rgba(255,255,255,0.1)",
            background: "linear-gradient(180deg, #0d1320, #080b14)",
            flexShrink: 0,
          }
        },
          React.createElement("button", {
            onClick: () => setVersion("fusion"),
            style: {
              flex: 1, padding: "12px 0", border: "none",
              background: version === "fusion" ? "rgba(183,148,244,0.15)" : "transparent",
              color: version === "fusion" ? "#b794f4" : "#4a5568",
              fontSize: "13px", fontWeight: 900, cursor: "pointer",
              borderTop: version === "fusion" ? "2px solid #b794f4" : "2px solid transparent",
              fontFamily: "'Noto Sans KR', sans-serif",
              marginTop: "-2px",
            }
          }, "üîÆ ÌîÑÎ°úÌÜ†_Ìï©ÏÑ±Î≤ÑÏ†Ñ"),
          React.createElement("button", {
            onClick: () => setVersion("shard"),
            style: {
              flex: 1, padding: "12px 0", border: "none",
              background: version === "shard" ? "rgba(99,179,237,0.15)" : "transparent",
              color: version === "shard" ? "#63b3ed" : "#4a5568",
              fontSize: "13px", fontWeight: 900, cursor: "pointer",
              borderTop: version === "shard" ? "2px solid #63b3ed" : "2px solid transparent",
              fontFamily: "'Noto Sans KR', sans-serif",
              marginTop: "-2px",
            }
          }, "üíé ÌîÑÎ°úÌÜ†_Ï°∞Í∞ÅÎ≤ÑÏ†Ñ")
        )
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(React.createElement(App));
  </script>
</body>
</html>
